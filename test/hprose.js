// Hprose for JavaScript v1.0.0
// Copyright (c) 2008-2016 http://hprose.com
// Hprose is freely distributable under the MIT license.
// For all details and documentation:
// https://github.com/hprose/hprose-js

if(function(e){"use strict";e.hprose={}}(this),function(e,t){"use strict";function r(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return function(t){return e.apply(t,Array.prototype.slice.call(arguments,1))}}var n="function"!=typeof Object.defineProperties?function(e,r){var n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];n.forEach(function(t){var n=r[t];"value"in n&&(e[t]=n.value)});for(var a in r){var i=r[a];e[a]=t,"value"in i?e[a]=i.value:"get"in i&&"set"in i?e[a]=function(e){return function(){return 0===arguments.length?e.get():void e.set(arguments[0])}}(i):"get"in i?e[a]=i.get:"set"in i&&(e[a]=i.set)}}:function(e,t){for(var r in t){var n=t[r];"get"in n&&"set"in n?t[r]={value:function(e){return function(){return 0===arguments.length?e.get():void e.set(arguments[0])}}(n)}:"get"in n?t[r]={value:n.get}:"set"in n&&(t[r]={value:n.set})}Object.defineProperties(e,t)},a=function(){},i="function"!=typeof Object.create?function(e,t){if("object"!=typeof e&&"function"!=typeof e)throw TypeError("prototype must be an object or function");a.prototype=e;var r=new a;return a.prototype=null,t&&n(r,t),r}:function(e,t){if(t){for(var r in t){var n=t[r];"get"in n&&"set"in n?t[r]={value:function(e){return function(){return 0===arguments.length?e.get():void e.set(arguments[0])}}(n)}:"get"in n?t[r]={value:n.get}:"set"in n&&(t[r]={value:n.set})}return Object.create(e,t)}return Object.create(e)};e.hprose.defineProperties=n,e.hprose.createObject=i,e.hprose.generic=r}(this),function(e,r){"use strict";function n(e,t){for(var r=e.prototype,n=0,a=t.length;a>n;n++){var u=t[n],o=r[u];"function"==typeof o&&"undefined"==typeof e[u]&&(e[u]=i(o))}}if(Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),r=this,n=function(){},a=function(){return r.apply(this instanceof n?this:e,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(n.prototype=this.prototype),a.prototype=new n,a}),"isArray"in Array||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(!this)throw new TypeError('"this" is null or not defined');var t=Object(this),r=t.length>>>0;if(0===r)return-1;var n=+Number(arguments[1])||0;if(Math.abs(n)===1/0&&(n=0),n>=r)return-1;for(var a=Math.max(n>=0?n:r-Math.abs(n),0);r>a;){if(a in t&&t[a]===e)return a;a++}return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){if(!this)throw new TypeError('"this" is null or not defined');var r=Object(this),n=r.length>>>0;if(0===n)return-1;var a=+Number(arguments[1])||0;Math.abs(a)===1/0&&(a=0);for(var i=a>=0?Math.min(a,n-1):n-Math.abs(a);i>=0;i--)if(i in t&&t[i]===e)return i;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e){if(!this)throw new TypeError("this is null or not defined");var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var n=[],a=arguments[1],i=0;r>i;i++)if(i in t){var u=t[i];e.call(a,u,i,t)&&n.push(u)}return n}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(!this)throw new TypeError("this is null or not defined");var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var n=arguments[1],a=0;r>a;a++)a in t&&e.call(n,t[a],a,t)}),Array.prototype.every||(Array.prototype.every=function(e){if(!this)throw new TypeError("this is null or not defined");var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var n=arguments[1],a=0;r>a;a++)if(a in t&&!e.call(n,t[a],a,t))return!1;return!0}),Array.prototype.map||(Array.prototype.map=function(e){if(!this)throw new TypeError("this is null or not defined");var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var n=arguments[1],a=new Array(r),i=0;r>i;i++)i in t&&(a[i]=e.call(n,t[i],i,t));return a}),Array.prototype.some||(Array.prototype.some=function(e){if(!this)throw new TypeError("this is null or not defined");var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var n=arguments[1],a=0;r>a;a++)if(a in t&&e.call(n,t[a],a,t))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){if(!this)throw new TypeError("this is null or not defined");var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("First argument is not callable");if(0===n&&1===arguments.length)throw new TypeError("Array length is 0 and no second argument");var a,i=0;for(arguments.length>=2?a=arguments[1]:(a=t[0],i=1);n>i;++i)i in t&&(a=e.call(r,a,t[i],i,t));return a}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){if(!this)throw new TypeError("this is null or not defined");var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("First argument is not callable");if(0===n&&1===arguments.length)throw new TypeError("Array length is 0 and no second argument");var a,i=n-1;if(arguments.length>=2)a=arguments[1];else for(;;){if(i in t){a=t[i--];break}if(--i<0)throw new TypeError("Array contains no values")}for(;i>=0;)i in t&&(a=e.call(r,a,t[i],i,t)),i--;return a}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var r=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>r.length)&&(t=r.length),t-=e.length;var n=r.indexOf(e,t);return-1!==n&&n===t}),String.prototype.includes||(String.prototype.includes=function(){return"number"==typeof arguments[1]?this.length<arguments[0].length+arguments[1].length?!1:this.substr(arguments[1],arguments[0].length)===arguments[0]:-1!==String.prototype.indexOf.apply(this,arguments)}),String.prototype.repeat||(String.prototype.repeat=function(e){var t=this.toString();if(e=+e,e!==e&&(e=0),0>e)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(e=Math.floor(e),0===t.length||0===e)return"";if(t.length*e>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var r="";1===(1&e)&&(r+=t),e>>>=1,0!==e;)t+=t;return r}),String.prototype.trim||(String.prototype.trim=function(){return this.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}),String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.toString().replace(/^[\s\xa0]+/,"")}),String.prototype.trimRight||(String.prototype.trimRight=function(){return this.toString().replace(/[\s\xa0]+$/,"")}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=r.length;return function(a){if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("Object.keys called on non-object");var i=[];for(var u in a)e.call(a,u)&&i.push(u);if(t)for(var o=0;n>o;o++)e.call(a,r[o])&&i.push(r[o]);return i}}()),Date.now||(Date.now=function(){return+new Date}),!Date.prototype.toISOString){var a=function(e){return 10>e?"0"+e:e};Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"}}var i=e.hprose.generic;n(Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight"]),n(String,["quote","substring","toLowerCase","toUpperCase","charAt","charCodeAt","indexOf","lastIndexOf","include","startsWith","endsWith","repeat","trim","trimLeft","trimRight","toLocaleLowerCase","toLocaleUpperCase","match","search","replace","split","substr","concat","slice"])}(this),function(e){"use strict";var t="WeakMap"in e,r="Map"in e,n=!0;if(r&&(n="forEach"in new e.Map),!(t&&r&&n)){var a="create"in Object,i=function(){return a?Object.create(null):{}},u=i(),o=0,s=function(e){var t=i(),r=e.valueOf,n=function(n,a){return this===e&&a in u&&u[a]===n?(a in t||(t[a]=i()),t[a]):r.apply(this,arguments)};a&&"defineProperty"in Object?Object.defineProperty(e,"valueOf",{value:n,writable:!0,configurable:!0,enumerable:!1}):e.valueOf=n};if(t||(e.WeakMap=function v(){var e=i(),t=o++;u[t]=e;var r=function(r){if(r!==Object(r))throw new Error("value is not a non-null object");var n=r.valueOf(e,t);return n!==r.valueOf()?n:(s(r),r.valueOf(e,t))},n=this;if(a?n=Object.create(v.prototype,{get:{value:function(e){return r(e).value},writable:!1,configurable:!1,enumerable:!1},set:{value:function(e,t){r(e).value=t},writable:!1,configurable:!1,enumerable:!1},has:{value:function(e){return"value"in r(e)},writable:!1,configurable:!1,enumerable:!1},"delete":{value:function(e){return delete r(e).value},writable:!1,configurable:!1,enumerable:!1},clear:{value:function(){delete u[t],t=o++,u[t]=e},writable:!1,configurable:!1,enumerable:!1}}):(n.get=function(e){return r(e).value},n.set=function(e,t){r(e).value=t},n.has=function(e){return"value"in r(e)},n["delete"]=function(e){return delete r(e).value},n.clear=function(){delete u[t],t=o++,u[t]=e}),arguments.length>0&&Array.isArray(arguments[0]))for(var c=arguments[0],f=0,l=c.length;l>f;f++)n.set(c[f][0],c[f][1]);return n}),!r){var c=function(){var e=i(),t=o++,r=i();u[t]=e;var n=function(n){if(null===n)return r;var a=n.valueOf(e,t);return a!==n.valueOf()?a:(s(n),n.valueOf(e,t))};return{get:function(e){return n(e).value},set:function(e,t){n(e).value=t},has:function(e){return"value"in n(e)},"delete":function(e){return delete n(e).value},clear:function(){delete u[t],t=o++,u[t]=e}}},f=function(){var e=i();return{get:function(){return e.value},set:function(t,r){e.value=r},has:function(){return"value"in e},"delete":function(){return delete e.value},clear:function(){e=i()}}},l=function(){var e=i();return{get:function(t){return e[t]},set:function(t,r){e[t]=r},has:function(t){return t in e},"delete":function(t){return delete e[t]},clear:function(){e=i()}}};if(!a)var h=function(){var e={};return{get:function(t){return e["!"+t]},set:function(t,r){e["!"+t]=r},has:function(t){return"!"+t in e},"delete":function(t){return delete e["!"+t]},clear:function(){e={}}}};e.Map=function p(){var e={number:l(),string:a?l():h(),"boolean":l(),object:c(),"function":c(),unknown:c(),undefined:f(),"null":f()},t=0,r=[],n=this;if(a?n=Object.create(p.prototype,{size:{get:function(){return t},configurable:!1,enumerable:!1},get:{value:function(t){return e[typeof t].get(t)},writable:!1,configurable:!1,enumerable:!1},set:{value:function(n,a){this.has(n)||(r.push(n),t++),e[typeof n].set(n,a)},writable:!1,configurable:!1,enumerable:!1},has:{value:function(t){return e[typeof t].has(t)},writable:!1,configurable:!1,enumerable:!1},"delete":{value:function(n){return this.has(n)?(t--,r.splice(r.indexOf(n),1),e[typeof n]["delete"](n)):!1},writable:!1,configurable:!1,enumerable:!1},clear:{value:function(){r.length=0;for(var n in e)e[n].clear();t=0},writable:!1,configurable:!1,enumerable:!1},forEach:{value:function(e,t){for(var n=0,a=r.length;a>n;n++)e.call(t,this.get(r[n]),r[n],this)},writable:!1,configurable:!1,enumerable:!1}}):(n.size=t,n.get=function(t){return e[typeof t].get(t)},n.set=function(n,a){this.has(n)||(r.push(n),this.size=++t),e[typeof n].set(n,a)},n.has=function(t){return e[typeof t].has(t)},n["delete"]=function(n){return this.has(n)?(this.size=--t,r.splice(r.indexOf(n),1),e[typeof n]["delete"](n)):!1},n.clear=function(){r.length=0;for(var n in e)e[n].clear();this.size=t=0},n.forEach=function(e,t){for(var n=0,a=r.length;a>n;n++)e.call(t,this.get(r[n]),r[n],this)}),arguments.length>0&&Array.isArray(arguments[0]))for(var i=arguments[0],u=0,o=i.length;o>u;u++)n.set(i[u][0],i[u][1]);return n}}if(!n){var g=e.Map;e.Map=function d(){var e=new g,t=0,r=[],n=Object.create(d.prototype,{size:{get:function(){return t},configurable:!1,enumerable:!1},get:{value:function(t){return e.get(t)},writable:!1,configurable:!1,enumerable:!1},set:{value:function(n,a){e.has(n)||(r.push(n),t++),e.set(n,a)},writable:!1,configurable:!1,enumerable:!1},has:{value:function(t){return e.has(t)},writable:!1,configurable:!1,enumerable:!1},"delete":{value:function(n){return e.has(n)?(t--,r.splice(r.indexOf(n),1),e["delete"](n)):!1},writable:!1,configurable:!1,enumerable:!1},clear:{value:function(){if("clear"in e)e.clear();else for(var n=0,a=r.length;a>n;n++)e["delete"](r[n]);r.length=0,t=0},writable:!1,configurable:!1,enumerable:!1},forEach:{value:function(e,t){for(var n=0,a=r.length;a>n;n++)e.call(t,this.get(r[n]),r[n],this)},writable:!1,configurable:!1,enumerable:!1}});if(arguments.length>0&&Array.isArray(arguments[0]))for(var a=arguments[0],i=0,u=a.length;u>i;i++)n.set(a[i][0],a[i][1]);return n}}}}(this),"function"!=typeof TimeoutError){var TimeoutError=function e(t){Error.call(this),this.message=t,this.name=e.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)};TimeoutError.prototype=hprose.createObject(Error.prototype),TimeoutError.prototype.constructor=TimeoutError}!function(e,t){"use strict";function r(e){var r=Array.prototype.slice.call(arguments,1);return function(){e.apply(t,r)}}function n(e){delete f[e]}function a(e){var t=f[e];if(t)try{t()}finally{n(e)}}function i(e){return f[c]=r.apply(t,e),c++}if(!e.setImmediate){var u=e.document,o=e.MutationObserver||e.WebKitMutationObserver||e.MozMutationOvserver,s={},c=1,f={};s.mutationObserver=function(){var e=[],t=u.createTextNode(""),r=new o(function(){for(;e.length>0;)a(e.shift())});return r.observe(t,{characterData:!0}),function(){var r=i(arguments);return e.push(r),t.data=1&r,r}},s.messageChannel=function(){var t=new e.MessageChannel;return t.port1.onmessage=function(e){a(Number(e.data))},function(){var e=i(arguments);return t.port2.postMessage(e),e}},s.nextTick=function(){return function(){var t=i(arguments);return e.process.nextTick(r(a,t)),t}},s.postMessage=function(){var e=u.createElement("iframe");e.style.display="none",u.documentElement.appendChild(e);var t=e.contentWindow;t.document.write('<script>window.onmessage=function(){parent.postMessage(1, "*");};</script>'),t.document.close();var r=[];return window.addEventListener("message",function(){for(;r.length>0;)a(r.shift())}),function(){var e=i(arguments);return r.push(e),t.postMessage(1,"*"),e}},s.readyStateChange=function(){var e=u.documentElement;return function(){var t=i(arguments),r=u.createElement("script");return r.onreadystatechange=function(){a(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r),t}},s.setTimeout=function(){return function(){var t=i(arguments);return e.setTimeout(r(a,t),0),t}};var l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"undefined"==typeof e.process||"[object process]"!==Object.prototype.toString.call(e.process)||e.process.browser?u&&"onreadystatechange"in u.createElement("script")?l.setImmediate=s.readyStateChange():u&&o?l.setImmediate=s.mutationObserver():e.MessageChannel?l.setImmediate=s.messageChannel():u&&"postMessage"in e&&"addEventListener"in e?l.setImmediate=s.postMessage():l.setImmediate=s.setTimeout():l.setImmediate=s.nextTick(),l.clearImmediate=n}}(this),function(e,t){"use strict";function r(e){var t=this;M(t,{_subscribers:{value:[]},resolve:{value:this.resolve.bind(t)},reject:{value:this.reject.bind(t)}}),"function"==typeof e&&W(function(){try{t.resolve(e())}catch(r){t.reject(r)}})}function n(e){return e instanceof r}function a(t){return n(t)||I&&t instanceof e.Promise&&typeof("function"===t.then)}function i(e,t){var n="function"==typeof t?t:function(){return t},a=new r;return N(function(){try{a.resolve(n())}catch(e){a.reject(e)}},e),a}function u(e){var t=new r;return t.reject(e),t}function o(e){var t=new r;return t.resolve(e),t}function s(e){try{var t=e();return o(t)}catch(r){return u(r)}}function c(e){var t=new r;return e(t.resolve,t.reject),t}function f(e){var t=0;return Array.forEach(e,function(){++t}),t}function l(e){return e=a(e)?e:o(e),e.then(function(e){var t=e.length,n=f(e),i=new Array(t);if(0===n)return o(i);var u=new r;return Array.forEach(e,function(e,t){var r=a(e)?e:o(e);r.then(function(e){i[t]=e,0===--n&&u.resolve(i)},u.reject)}),u})}function h(){return l(arguments)}function g(e){return e=a(e)?e:o(e),e.then(function(e){var t=new r;return Array.forEach(e,function(e){var r=a(e)?e:o(e);r.then(t.resolve,t.reject)}),t})}function v(e){return e=a(e)?e:o(e),e.then(function(e){var t=e.length,n=f(e);if(0===n)throw new RangeError("any(): array must not be empty");var i=new Array(t),u=new r;return Array.forEach(e,function(e,t){var r=a(e)?e:o(e);r.then(u.resolve,function(e){i[t]=e,0===--n&&u.reject(i)})}),u})}function p(e){return e=a(e)?e:o(e),e.then(function(e){var t=e.length,n=f(e),i=new Array(t);if(0===n)return o(i);var u=new r;return Array.forEach(e,function(e,t){var r=a(e)?e:o(e);r.whenComplete(function(){i[t]=r.inspect(),0===--n&&u.resolve(i)})}),u})}function d(e){var r=Array.slice(arguments,1);return l(r).then(function(r){return e.apply(t,r)})}function w(e,t){var r=Array.slice(arguments,2);return l(r).then(function(r){return e.apply(t,r)})}function y(e,t){return function(){return l(arguments).then(function(r){return e.apply(t,r)})}}function m(e,t,r){return l(e).then(function(e){return e.forEach(t,r)})}function b(e,t,r){return l(e).then(function(e){return e.every(t,r)})}function T(e,t,r){return l(e).then(function(e){return e.some(t,r)})}function C(e,t,r){return l(e).then(function(e){return e.filter(t,r)})}function E(e,t,r){return l(e).then(function(e){return e.map(t,r)})}function _(e,t,r){return arguments.length>2?l(e).then(function(e){return a(r)||(r=o(r)),r.then(function(r){return e.reduce(t,r)})}):l(e).then(function(e){return e.reduce(t)})}function A(e,t,r){return arguments.length>2?l(e).then(function(e){return a(r)||(r=o(r)),r.then(function(r){return e.reduceRight(t,r)})}):l(e).then(function(e){return e.reduceRight(t)})}function O(e,t,r){W(function(){try{var n=e(r);t.resolve(n)}catch(a){t.reject(a)}})}function S(e,t,r){e?O(e,t,r):t.reject(r)}function j(e,t,r,n,i){function u(a){j(e,t,r,n,a)}function o(e){S(t,n,e)}if(a(i))return i===r?void o(new TypeError("Self resolution")):void i.then(u,o);if(null!==i&&"object"==typeof i||"function"==typeof i){var s;try{s=i.then}catch(c){return void o(c)}if("function"==typeof s){var f=!0;try{return void s.call(i,function(e){f&&(f=!1,u(e))},function(e){f&&(f=!1,o(e))})}catch(c){f&&(f=!1,o(c))}return}}e?O(e,n,i):n.resolve(i)}function k(){var e=new r;M(this,{future:{value:e},complete:{value:e.resolve},completeError:{value:e.reject},isCompleted:{get:function(){return e._state!==U}}})}var U=0,R=1,x=2,M=e.hprose.defineProperties,F=e.hprose.createObject,I="Promise"in e,W=e.setImmediate,N=e.setTimeout,L=e.clearTimeout;M(r,{delayed:{value:i},error:{value:u},sync:{value:s},value:{value:o},all:{value:l},race:{value:g},resolve:{value:o},reject:{value:u},promise:{value:c},isFuture:{value:n},isPromise:{value:a},join:{value:h},any:{value:v},settle:{value:p},attempt:{value:d},run:{value:w},wrap:{value:y},forEach:{value:m},every:{value:b},some:{value:T},filter:{value:C},map:{value:E},reduce:{value:_},reduceRight:{value:A}}),M(r.prototype,{_value:{writable:!0},_reason:{writable:!0},_state:{value:U,writable:!0},resolve:{value:function(e){if(this._state===U){this._state=R,this._value=e;for(var t=this._subscribers;t.length>0;){var r=t.shift();j(r.onfulfill,r.onreject,this,r.next,e)}}}},reject:{value:function(e){if(this._state===U){this._state=x,this._reason=e;for(var t=this._subscribers;t.length>0;){var r=t.shift();r.onreject?O(r.onreject,r.next,e):r.next.reject(e)}}}},then:{value:function(e,t){if("function"!=typeof e&&(e=null),"function"!=typeof t&&(t=null),e||t){var n=new r;return this._state===R?e?j(e,t,this,n,this._value):n.resolve(this._value):this._state===x?t?O(t,n,this._reason):n.reject(this._reason):this._subscribers.push({onfulfill:e,onreject:t,next:n}),n}return this}},inspect:{value:function(){switch(this._state){case U:return{state:"pending"};case R:return{state:"fulfilled",value:this._value};case x:return{state:"rejected",reason:this._reason}}}},catchError:{value:function(e,t){if("function"==typeof t){var r=this;return this["catch"](function(n){if(t(n))return r["catch"](e);throw n})}return this["catch"](e)}},"catch":{value:function(e){return this.then(null,e)}},whenComplete:{value:function(e){return this.then(function(r){var n=e();return n===t?r:(n=a(n)?n:o(n),n.then(function(){return r}))},function(r){var n=e();if(n===t)throw r;return n=a(n)?n:o(n),n.then(function(){throw r})})}},timeout:{value:function(e,t){var n=new r,a=N(function(){n.reject(t||new TimeoutError("timeout"))},e);return this.whenComplete(function(){L(a)}).then(n.resolve,n.reject),n}},delay:{value:function(e){var t=new r;return this.then(function(r){N(function(){t.resolve(r)},e)},t.reject),t}},tap:{value:function(e,t){return this.then(function(r){return e.call(t,r),r})}},spread:{value:function(e,t){return this.then(function(r){return e.apply(t,r)})}},get:{value:function(e){return this.then(function(t){return t[e]})}},set:{value:function(e,t){return this.then(function(r){return r[e]=t,r})}},apply:{value:function(e,t){return t=t||[],this.then(function(r){return l(t).then(function(t){return r[e].apply(r,t)})})}},call:{value:function(e){var t=Array.slice(arguments,1);return this.then(function(r){return l(t).then(function(t){return r[e].apply(r,t)})})}},bind:{value:function(e){var t=Array.slice(arguments);{if(!Array.isArray(e)){t.shift();var r=this;return Object.defineProperty(this,e,{value:function(){var n=Array.slice(arguments);return r.then(function(r){return l(t.concat(n)).then(function(t){return r[e].apply(r,t)})})}}),this}for(var n=0,a=e.length;a>n;++n)t[0]=e[n],this.bind.apply(this,t)}}},forEach:{value:function(e,t){return m(this,e,t)}},every:{value:function(e,t){return b(this,e,t)}},some:{value:function(e,t){return T(this,e,t)}},filter:{value:function(e,t){return C(this,e,t)}},map:{value:function(e,t){return E(this,e,t)}},reduce:{value:function(e,t){return arguments.length>1?_(this,e,t):_(this,e)}},reduceRight:{value:function(e,t){return arguments.length>1?A(this,e,t):A(this,e)}}}),e.hprose.Future=r,e.hprose.Completer=k,e.hprose.resolved=o,e.hprose.rejected=u,e.hprose.deferred=function(){var e=new r;return F(null,{promise:{value:e},resolve:{value:e.resolve},reject:{value:e.reject}})},I||(e.Promise=function(e){r.call(this),e(this.resolve,this.reject)},e.Promise.prototype=F(r.prototype),e.Promise.prototype.constructor=r,M(e.Promise,{all:{value:l},race:{value:g},resolve:{value:o},reject:{value:u}}))}(this),function(e){"use strict";function t(e){if(!/^[\x00-\xff]*$/.test(e))throw new Error("argument is not a binary string.");r(this,{length:{value:e.length},toString:{value:function(){return e}},valueOf:{value:function(){return e},writable:!0,configurable:!0,enumerable:!1}})}var r=e.hprose.defineProperties,n=e.hprose.createObject,a={};["quote","substring","toLowerCase","toUpperCase","charAt","charCodeAt","indexOf","lastIndexOf","include","startsWith","endsWith","repeat","trim","trimLeft","trimRight","toLocaleLowerCase","toLocaleUpperCase","match","search","replace","split","substr","concat","slice"].forEach(function(e){a[e]={value:String.prototype[e]}}),t.prototype=n(null,a),t.prototype.constructor=t,e.hprose.BinaryString=t,e.hprose.binary=function(e){return new t(e)}}(this),function(e,t){"use strict";function r(e){return String.fromCharCode(e>>>24&255,e>>>16&255,e>>>8&255,255&e)}function n(e){return String.fromCharCode(255&e,e>>>8&255,e>>>16&255,e>>>24&255)}function a(e){if(/^[\x00-\x7f]*$/.test(e))return e;for(var t=[],r=e.length,n=0,a=0;r>n;++n,++a){var i=e.charCodeAt(n);if(128>i)t[a]=e.charAt(n);else if(2048>i)t[a]=String.fromCharCode(192|i>>6,128|63&i);else{if(!(55296>i||i>57343)){if(r>n+1){var u=e.charCodeAt(n+1);if(56320>i&&u>=56320&&57343>=u){var o=((1023&i)<<10|1023&u)+65536;t[a]=String.fromCharCode(240|o>>18&63,128|o>>12&63,128|o>>6&63,128|63&o),++n;continue}}throw new Error("Malformed string")}t[a]=String.fromCharCode(224|i>>12,128|i>>6&63,128|63&i)}}return t.join("")}function i(e,t){for(var r=new Array(t),n=0,a=0,i=e.length;t>n&&i>a;n++){var u=e.charCodeAt(a++);switch(u>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r[n]=u;break;case 12:case 13:if(!(i>a))throw new Error("Unfinished UTF-8 octet sequence");r[n]=(31&u)<<6|63&e.charCodeAt(a++);break;case 14:if(!(i>a+1))throw new Error("Unfinished UTF-8 octet sequence");r[n]=(15&u)<<12|(63&e.charCodeAt(a++))<<6|63&e.charCodeAt(a++);break;case 15:if(!(i>a+2))throw new Error("Unfinished UTF-8 octet sequence");var o=((7&u)<<18|(63&e.charCodeAt(a++))<<12|(63&e.charCodeAt(a++))<<6|63&e.charCodeAt(a++))-65536;if(!(o>=0&&1048575>=o))throw new Error("Character outside valid Unicode range: 0x"+o.toString(16));r[n++]=o>>10&1023|55296,r[n]=1023&o|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+u.toString(16))}}return t>n&&(r.length=n),[String.fromCharCode.apply(String,r),a]}function u(e,t){for(var r=[],n=new Array(65535),a=0,i=0,u=e.length;t>a&&u>i;a++){var o=e.charCodeAt(i++);switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n[a]=o;break;case 12:case 13:if(!(u>i))throw new Error("Unfinished UTF-8 octet sequence");n[a]=(31&o)<<6|63&e.charCodeAt(i++);break;case 14:if(!(u>i+1))throw new Error("Unfinished UTF-8 octet sequence");n[a]=(15&o)<<12|(63&e.charCodeAt(i++))<<6|63&e.charCodeAt(i++);break;case 15:if(!(u>i+2))throw new Error("Unfinished UTF-8 octet sequence");var s=((7&o)<<18|(63&e.charCodeAt(i++))<<12|(63&e.charCodeAt(i++))<<6|63&e.charCodeAt(i++))-65536;if(!(s>=0&&1048575>=s))throw new Error("Character outside valid Unicode range: 0x"+s.toString(16));n[a++]=s>>10&1023|55296,n[a]=1023&s|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+o.toString(16))}if(a>=65534){var c=a+1;n.length=c,r[r.length]=String.fromCharCode.apply(String,n),t-=c,a=-1}}return a>0&&(n.length=a,r[r.length]=String.fromCharCode.apply(String,n)),[r.join(""),i]}function o(e,r){return(r===t||null===r||0>r)&&(r=e.length),0===r?["",0]:/^[\x00-\x7f]*$/.test(e)||!/^[\x00-\xff]*$/.test(e)?r===e.length?[e,r]:[e.substr(0,r),r]:1e5>r?i(e,r):u(e,r)}function s(e,r){if((r===t||null===r||0>r)&&(r=e.length),0===r)return"";if(/^[\x00-\x7f]*$/.test(e))return r===e.length?e:e.substr(0,r);if(!/^[\x00-\xff]*$/.test(e))throw new Error("The first argument must be an UTF8 encode binary string.");for(var n=0,a=0,i=e.length;r>n&&i>a;n++){var u=e.charCodeAt(a++);switch(u>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;case 12:case 13:if(!(i>a))throw new Error("Unfinished UTF-8 octet sequence");++a;break;case 14:if(!(i>a+1))throw new Error("Unfinished UTF-8 octet sequence");a+=2;break;case 15:if(i>a+2){var o=((7&u)<<18|(63&e.charCodeAt(a++))<<12|(63&e.charCodeAt(a++))<<6|63&e.charCodeAt(a++))-65536;if(o>=0&&1048575>=o)break;throw new Error("Character outside valid Unicode range: 0x"+o.toString(16))}throw new Error("Unfinished UTF-8 octet sequence");default:throw new Error("Bad UTF-8 encoding 0x"+u.toString(16))}}return e.substr(0,a)}function c(e){return o(e)[0]}function f(e){var t=e.length;if(/^[\x00-\x7f]*$/.test(e))return t;for(var r=0,n=0;t>n;++n){var a=e.charCodeAt(n);if(128>a)++r;else if(2048>a)r+=2;else{if(!(55296>a||a>57343)){if(t>n+1){var i=e.charCodeAt(n+1);if(56320>a&&i>=56320&&57343>=i){++n,r+=4;continue}}throw new Error("Malformed string")}r+=3}}return r}function l(e){var t=e.length;if(/^[\x00-\x7f]*$/.test(e)||!/^[\x00-\xff]*$/.test(e))return t;for(var r=0,n=0;t>n;++n,++r){var a=e.charCodeAt(n);switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;case 12:case 13:if(!(t>n))throw new Error("Unfinished UTF-8 octet sequence");++n;break;case 14:if(!(t>n+1))throw new Error("Unfinished UTF-8 octet sequence");n+=2;break;case 15:if(!(t>n+2))throw new Error("Unfinished UTF-8 octet sequence");var i=((7&a)<<18|(63&e.charCodeAt(n++))<<12|(63&e.charCodeAt(n++))<<6|63&e.charCodeAt(n++))-65536;if(!(i>=0&&1048575>=i))throw new Error("Character outside valid Unicode range: 0x"+i.toString(16));++r;break;default:throw new Error("Bad UTF-8 encoding 0x"+a.toString(16))}}return r}function h(e){if(/^[\x00-\x7f]*$/.test(e))return!0;if(!/^[\x00-\xff]*$/.test(e))return!1;for(var t=0,r=e.length;r>t;++t){var n=e.charCodeAt(t);switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;case 12:case 13:if(!(r>t))return!1;++t;break;case 14:if(!(r>t+1))return!1;t+=2;break;case 15:if(!(r>t+2))return!1;var a=((7&n)<<18|(63&e.charCodeAt(t++))<<12|(63&e.charCodeAt(t++))<<6|63&e.charCodeAt(t++))-65536;if(!(a>=0&&1048575>=a))return!1;break;default:return!1}}return!0}function g(){var e=arguments;switch(e.length){case 1:this._buffer=[e[0].toString()];break;case 2:this._buffer=[e[0].toString().substr(e[1])];break;case 3:this._buffer=[e[0].toString().substr(e[1],e[2])];break;default:this._buffer=[""]}this.mark()}var v=e.hprose.defineProperties;v(g.prototype,{_buffer:{writable:!0},_off:{value:0,writable:!0},_wmark:{writable:!0},_rmark:{writable:!0},toString:{value:function(){return this._buffer.length>1&&(this._buffer=[this._buffer.join("")]),this._buffer[0]}},length:{get:function(){return this.toString().length}},position:{get:function(){return this._off}},mark:{value:function(){this._wmark=this.length(),this._rmark=this._off}},reset:{value:function(){this._buffer=[this.toString().substr(0,this._wmark)],this._off=this._rmark}},clear:{value:function(){this._buffer=[""],this._wmark=0,this._off=0,this._rmark=0}},writeByte:{value:function(e){this._buffer.push(String.fromCharCode(255&e))}},writeInt32BE:{value:function(e){if(e===(0|e)&&2147483647>=e)return void this._buffer.push(r(e));throw new TypeError("value is out of bounds")}},writeUInt32BE:{value:function(e){if((2147483647&e)+2147483648===e&&e>=0)return void this._buffer.push(r(0|e));throw new TypeError("value is out of bounds")}},writeInt32LE:{value:function(e){if(e===(0|e)&&2147483647>=e)return void this._buffer.push(n(e));throw new TypeError("value is out of bounds")}},writeUInt32LE:{value:function(e){if((2147483647&e)+2147483648===e&&e>=0)return void this._buffer.push(n(0|e));throw new TypeError("value is out of bounds")}},writeUTF16AsUTF8:{value:function(e){this._buffer.push(a(e))}},writeUTF8AsUTF16:{value:function(e){this._buffer.push(c(e))}},write:{value:function(e){this._buffer.push(e)}},readByte:{value:function(){return this._off<this.length()?this._buffer[0].charCodeAt(this._off++):-1}},readChar:{value:function(){return this._off<this.length()?this._buffer[0].charAt(this._off++):""}},readInt32BE:{value:function(){var e=this.length(),t=this._buffer[0],r=this._off;if(e>r+3){var n=t.charCodeAt(r++)<<24|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<8|t.charCodeAt(r++);return this._off=r,n}throw new Error("EOF")}},readUInt32BE:{value:function(){var e=this.readInt32BE();return 0>e?(2147483647&e)+2147483648:e}},readInt32LE:{value:function(){var e=this.length(),t=this._buffer[0],r=this._off;if(e>r+3){var n=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;return this._off=r,n}throw new Error("EOF")}},readUInt32LE:{value:function(){var e=this.readInt32LE();return 0>e?(2147483647&e)+2147483648:e}},read:{value:function(e){var t=this._off,r=this.length();return t+e>r&&(e=r-t),0===e?"":(this._off=t+e,this._buffer[0].substring(t,this._off))}},skip:{value:function(e){var t=this.length();return this._off+e>t?(e=t-this._off,this._off=t):this._off+=e,e}},readString:{value:function(e){var t=this.length(),r=this._off,n=this._buffer[0],a=n.indexOf(e,r);return-1===a?(n=n.substr(r),this._off=t):(n=n.substring(r,a+1),this._off=a+1),n}},readUntil:{
value:function(e){var t=this.length(),r=this._off,n=this._buffer[0],a=n.indexOf(e,r);return a===this._off?(n="",this._off++):-1===a?(n=n.substr(r),this._off=t):(n=n.substring(r,a),this._off=a+1),n}},readUTF8:{value:function(e){var t=this.length(),r=s(this._buffer[0].substring(this._off,Math.min(this._off+3*e,t)),e);return this._off+=r.length,r}},readUTF8AsUTF16:{value:function(e){var t=this.length(),r=o(this._buffer[0].substring(this._off,Math.min(this._off+3*e,t)),e);return this._off+=r[1],r[0]}},readUTF16AsUTF8:{value:function(e){return a(this.read(e))}},take:{value:function(){var e=this.toString();return this.clear(),e}},clone:{value:function(){return new g(this.toString())}},trunc:{value:function(){var e=this.toString().substring(this._off,this._length);this._buffer[0]=e,this._off=0,this._wmark=0,this._rmark=0}}}),v(g,{utf8Encode:{value:a},utf8Decode:{value:c},utf8Length:{value:f},utf16Length:{value:l},isUTF8:{value:h}}),e.hprose.StringIO=g}(this),function(e){"use strict";e.HproseTags=e.hprose.Tags={TagInteger:"i",TagLong:"l",TagDouble:"d",TagNull:"n",TagEmpty:"e",TagTrue:"t",TagFalse:"f",TagNaN:"N",TagInfinity:"I",TagDate:"D",TagTime:"T",TagUTC:"Z",TagBytes:"b",TagUTF8Char:"u",TagString:"s",TagGuid:"g",TagList:"a",TagMap:"m",TagClass:"c",TagObject:"o",TagRef:"r",TagPos:"+",TagNeg:"-",TagSemicolon:";",TagOpenbrace:"{",TagClosebrace:"}",TagQuote:'"',TagPoint:".",TagFunctions:"F",TagCall:"C",TagResult:"R",TagArgument:"A",TagError:"E",TagEnd:"z"}}(this),function(e){"use strict";function t(e,t){o.set(e,t),u[t]=e}function r(e){return o.get(e)}function n(e){return u[e]}var a=e.WeakMap,i=e.hprose.createObject,u=i(null),o=new a;e.HproseClassManager=e.hprose.ClassManager=i(null,{register:{value:t},getClassAlias:{value:r},getClass:{value:n}}),e.hprose.register=t,t(Object,"Object")}(this),function(e,t){"use strict";function r(e){var t=e.constructor,r=A.getClassAlias(t);if(r)return r;if(t.name)r=t.name;else{var n=t.toString();if(r=n.substr(0,n.indexOf("(")).replace(/(^\s*function\s*)|(\s*$)/gi,""),""===r||"Object"===r)return"function"==typeof e.getClassName?e.getClassName():"Object"}return"Object"!==r&&A.register(t,r),r}function n(e){O(this,{_stream:{value:e},_ref:{value:new T,writable:!0}})}function a(e){return new n(e)}function i(e,t,r){this.binary=!!r,O(this,{stream:{value:e},_classref:{value:S(null),writable:!0},_fieldsref:{value:[],writable:!0},_refer:{value:t?k:a(e)}})}function u(e,n){var a=e.stream;if(n===t||null===n||n.constructor===Function)return void a.write(_.TagNull);if(""===n)return void a.write(_.TagEmpty);switch(n.constructor){case Number:o(e,n);break;case Boolean:f(e,n);break;case String:1===n.length?(a.write(_.TagUTF8Char),a.write(e.binary?j(n):n)):e.writeStringWithRef(n);break;case E:if(!e.binary)throw new Error("The binary string does not support serialization in text mode.");e.writeBinaryWithRef(n);break;case Date:e.writeDateWithRef(n);break;case T:e.writeMapWithRef(n);break;default:if(Array.isArray(n))e.writeListWithRef(n);else{var i=r(n);"Object"===i?e.writeMapWithRef(n):e.writeObjectWithRef(n)}}}function o(e,t){var r=e.stream;t=t.valueOf(),t===(0|t)?t>=0&&9>=t?r.write(t):(r.write(_.TagInteger),r.write(t),r.write(_.TagSemicolon)):c(e,t)}function s(e,t){var r=e.stream;t>=0&&9>=t?r.write(t):(-2147483648>t||t>2147483647?r.write(_.TagLong):r.write(_.TagInteger),r.write(t),r.write(_.TagSemicolon))}function c(e,t){var r=e.stream;t!==t?r.write(_.TagNaN):t!==1/0&&t!==-(1/0)?(r.write(_.TagDouble),r.write(t),r.write(_.TagSemicolon)):(r.write(_.TagInfinity),r.write(t>0?_.TagPos:_.TagNeg))}function f(e,t){e.stream.write(t.valueOf()?_.TagTrue:_.TagFalse)}function l(e,t){e._refer.set(t);var r=e.stream;r.write(_.TagDate),r.write(("0000"+t.getUTCFullYear()).slice(-4)),r.write(("00"+(t.getUTCMonth()+1)).slice(-2)),r.write(("00"+t.getUTCDate()).slice(-2)),r.write(_.TagTime),r.write(("00"+t.getUTCHours()).slice(-2)),r.write(("00"+t.getUTCMinutes()).slice(-2)),r.write(("00"+t.getUTCSeconds()).slice(-2));var n=t.getUTCMilliseconds();0!==n&&(r.write(_.TagPoint),r.write(("000"+n).slice(-3))),r.write(_.TagUTC)}function h(e,t){e._refer.set(t);var r=e.stream,n=("0000"+t.getFullYear()).slice(-4),a=("00"+(t.getMonth()+1)).slice(-2),i=("00"+t.getDate()).slice(-2),u=("00"+t.getHours()).slice(-2),o=("00"+t.getMinutes()).slice(-2),s=("00"+t.getSeconds()).slice(-2),c=("000"+t.getMilliseconds()).slice(-3);"00"===u&&"00"===o&&"00"===s&&"000"===c?(r.write(_.TagDate),r.write(n),r.write(a),r.write(i)):"1970"===n&&"01"===a&&"01"===i?(r.write(_.TagTime),r.write(u),r.write(o),r.write(s),"000"!==c&&(r.write(_.TagPoint),r.write(c))):(r.write(_.TagDate),r.write(n),r.write(a),r.write(i),r.write(_.TagTime),r.write(u),r.write(o),r.write(s),"000"!==c&&(r.write(_.TagPoint),r.write(c))),r.write(_.TagSemicolon)}function g(e,t){e._refer.set(t);var r=e.stream,n=("00"+t.getHours()).slice(-2),a=("00"+t.getMinutes()).slice(-2),i=("00"+t.getSeconds()).slice(-2),u=("000"+t.getMilliseconds()).slice(-3);r.write(_.TagTime),r.write(n),r.write(a),r.write(i),"000"!==u&&(r.write(_.TagPoint),r.write(u)),r.write(_.TagSemicolon)}function v(e,t){e._refer.set(t);var r=e.stream;r.write(_.TagBytes);var n=t.length;n>0&&r.write(n),r.write(_.TagQuote),n>0&&r.write(t),r.write(_.TagQuote)}function p(e,t){e._refer.set(t);var r=e.stream,n=t.length;r.write(_.TagString),n>0&&r.write(n),r.write(_.TagQuote),n>0&&r.write(e.binary?j(t):t),r.write(_.TagQuote)}function d(e,t){e._refer.set(t);var r=e.stream,n=t.length;r.write(_.TagList),n>0&&r.write(n),r.write(_.TagOpenbrace);for(var a=0;n>a;a++)u(e,t[a]);r.write(_.TagClosebrace)}function w(e,t){e._refer.set(t);var r=e.stream,n=[];for(var a in t)t.hasOwnProperty(a)&&"function"!=typeof t[a]&&(n[n.length]=a);var i=n.length;r.write(_.TagMap),i>0&&r.write(i),r.write(_.TagOpenbrace);for(var o=0;i>o;o++)u(e,n[o]),u(e,t[n[o]]);r.write(_.TagClosebrace)}function y(e,t){e._refer.set(t);var r=e.stream,n=t.size;r.write(_.TagMap),n>0&&r.write(n),r.write(_.TagOpenbrace),t.forEach(function(t,r){u(e,r),u(e,t)}),r.write(_.TagClosebrace)}function m(e,t){var n,a,i=e.stream,o=r(t);if(o in e._classref)a=e._classref[o],n=e._fieldsref[a];else{n=[];for(var s in t)t.hasOwnProperty(s)&&"function"!=typeof t[s]&&(n[n.length]=s.toString());a=b(e,o,n)}i.write(_.TagObject),i.write(a),i.write(_.TagOpenbrace),e._refer.set(t);for(var c=n.length,f=0;c>f;f++)u(e,t[n[f]]);i.write(_.TagClosebrace)}function b(e,t,r){var n=e.stream,a=r.length;n.write(_.TagClass),n.write(t.length),n.write(_.TagQuote),n.write(e.binary?j(t):t),n.write(_.TagQuote),a>0&&n.write(a),n.write(_.TagOpenbrace);for(var i=0;a>i;i++)p(e,r[i]);n.write(_.TagClosebrace);var u=e._fieldsref.length;return e._classref[t]=u,e._fieldsref[u]=r,u}var T=e.Map,C=e.hprose.StringIO,E=e.hprose.BinaryString,_=e.hprose.Tags,A=e.hprose.ClassManager,O=e.hprose.defineProperties,S=e.hprose.createObject,j=C.utf8Encode,k=S(null,{set:{value:function(){}},write:{value:function(){return!1}},reset:{value:function(){}}});O(n.prototype,{_refcount:{value:0,writable:!0},set:{value:function(e){this._ref.set(e,this._refcount++)}},write:{value:function(e){var r=this._ref.get(e);return r!==t?(this._stream.write(_.TagRef),this._stream.write(r),this._stream.write(_.TagSemicolon),!0):!1}},reset:{value:function(){this._ref=new T,this._refcount=0}}}),O(i.prototype,{binary:{value:!1,writable:!0},serialize:{value:function(e){u(this,e)}},writeInteger:{value:function(e){s(this,e)}},writeDouble:{value:function(e){c(this,e)}},writeBoolean:{value:function(e){f(this,e)}},writeUTCDate:{value:function(e){l(this,e)}},writeUTCDateWithRef:{value:function(e){this._refer.write(e)||l(this,e)}},writeDate:{value:function(e){h(this,e)}},writeDateWithRef:{value:function(e){this._refer.write(e)||h(this,e)}},writeTime:{value:function(e){g(this,e)}},writeTimeWithRef:{value:function(e){this._refer.write(e)||g(this,e)}},writeBinary:{value:function(e){v(this,e)}},writeBinaryWithRef:{value:function(e){this._refer.write(e)||v(this,e)}},writeString:{value:function(e){p(this,e)}},writeStringWithRef:{value:function(e){this._refer.write(e)||p(this,e)}},writeList:{value:function(e){d(this,e)}},writeListWithRef:{value:function(e){this._refer.write(e)||d(this,e)}},writeMap:{value:function(e){e instanceof T?y(this,e):w(this,e)}},writeMapWithRef:{value:function(e){this._refer.write(e)||this.writeMap(e)}},writeObject:{value:function(e){m(this,e)}},writeObjectWithRef:{value:function(e){this._refer.write(e)||m(this,e)}},reset:{value:function(){this._classref=S(null),this._fieldsref.length=0,this._refer.reset()}}}),e.HproseWriter=e.hprose.Writer=i}(this),function(e,t){"use strict";function r(e,t){if(e&&t)throw new Error('Tag "'+t+'" expected, but "'+e+'" found in stream');if(e)throw new Error('Unexpected serialize tag "'+e+'" in stream');throw new Error("No byte found in stream")}function n(e,t){var r=new X;return a(e,r,t),r.take()}function a(e,t,r){i(e,t,e.readChar(),r)}function i(e,t,n,i){switch(t.write(n),n){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case te.TagNull:case te.TagEmpty:case te.TagTrue:case te.TagFalse:case te.TagNaN:break;case te.TagInfinity:t.write(e.read());break;case te.TagInteger:case te.TagLong:case te.TagDouble:case te.TagRef:u(e,t);break;case te.TagDate:case te.TagTime:o(e,t);break;case te.TagUTF8Char:s(e,t,i);break;case te.TagBytes:c(e,t,i);break;case te.TagString:f(e,t,i);break;case te.TagGuid:l(e,t);break;case te.TagList:case te.TagMap:case te.TagObject:h(e,t,i);break;case te.TagClass:h(e,t,i),a(e,t,i);break;case te.TagError:a(e,t,i);break;default:r(n)}}function u(e,t){var r;do r=e.read(),t.write(r);while(r!==te.TagSemicolon)}function o(e,t){var r;do r=e.read(),t.write(r);while(r!==te.TagSemicolon&&r!==te.TagUTC)}function s(e,t,r){r?t.write(e.readUTF8(1)):t.write(e.readChar())}function c(e,t,r){if(!r)throw new Error("The binary string does not support to unserialize in text mode.");var n=e.readUntil(te.TagQuote);t.write(n),t.write(te.TagQuote);var a=0;n.length>0&&(a=parseInt(n,10)),t.write(e.read(len+1))}function f(e,t,r){var n=e.readUntil(te.TagQuote);t.write(n),t.write(te.TagQuote);var a=0;n.length>0&&(a=parseInt(n,10)),r?t.write(e.readUTF8(len+1)):t.write(e.read(len+1))}function l(e,t){t.write(e.read(38))}function h(e,t,r){var n;do n=e.readChar(),t.write(n);while(n!==te.TagOpenbrace);for(;(n=e.readChar())!==te.TagClosebrace;)i(e,t,n,r);t.write(n)}function g(e,t){ne(this,{stream:{value:e},binary:{value:!!t,writable:!0},readRaw:{value:function(){return n(e,this.binary)}}})}function v(){ne(this,{ref:{value:[]}})}function p(){return new v}function d(r){var n,a=e,i=r.split(".");for(n=0;n<i.length;n++)if(a=a[i[n]],a===t)return null;return a}function w(e,t,r,n){if(r<t.length){var a=t[r];e[a]=n;var i=w(e,t,r+1,".");return r+1<t.length&&null===i&&(i=w(e,t,r+1,"_")),i}var u=e.join("");try{var o=d(u);return"function"==typeof o?o:null}catch(s){return null}}function y(e){var t=re.getClass(e);if(t)return t;if(t=d(e),"function"==typeof t)return re.register(t,e),t;for(var r=[],n=e.indexOf("_");n>=0;)r[r.length]=n,n=e.indexOf("_",n+1);if(r.length>0){var a=e.split("");if(t=w(a,r,0,"."),null===t&&(t=w(a,r,0,"_")),"function"==typeof t)return re.register(t,e),t}return t=function(){},defineProperty(t.prototype,"getClassName",{value:function(){return e}}),re.register(t,e),t}function m(e,t){var r=e.readUntil(t);return 0===r.length?0:parseInt(r,10)}function b(e){var t=e.stream,n=t.readChar();switch(n){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case te.TagInteger:return T(t);case te.TagLong:return E(t);case te.TagDouble:return A(t);case te.TagNull:return null;case te.TagEmpty:return"";case te.TagTrue:return!0;case te.TagFalse:return!1;case te.TagNaN:return NaN;case te.TagInfinity:return S(t);case te.TagDate:return k(e);case te.TagTime:return R(e);case te.TagBytes:return M(e);case te.TagUTF8Char:return I(e);case te.TagString:return N(e);case te.TagGuid:return D(e);case te.TagList:return z(e);case te.TagMap:return e.useHarmonyMap?$(e):H(e);case te.TagClass:return Z(e),Y(e);case te.TagObject:return G(e);case te.TagRef:return K(e);case te.TagError:throw new Error(L(e));default:r(n)}}function T(e){return m(e,te.TagSemicolon)}function C(e){var t=e.readChar();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case te.TagInteger:return T(e);default:r(t)}}function E(e){var t=e.readUntil(te.TagSemicolon),r=parseInt(t,10);return r.toString()===t?r:t}function _(e){var t=e.readChar();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case te.TagInteger:case te.TagLong:return E(e);default:r(t)}}function A(e){return parseFloat(e.readUntil(te.TagSemicolon))}function O(e){var t=e.readChar();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case te.TagInteger:case te.TagLong:case te.TagDouble:return A(e);case te.TagNaN:return NaN;case te.TagInfinity:return S(e);default:r(t)}}function S(e){return e.readChar()===te.TagNeg?-(1/0):1/0}function j(e){var t=e.readChar();switch(t){case te.TagTrue:return!0;case te.TagFalse:return!1;default:r(t)}}function k(e){var t,r=e.stream,n=parseInt(r.read(4),10),a=parseInt(r.read(2),10)-1,i=parseInt(r.read(2),10),u=r.readChar();if(u===te.TagTime){var o=parseInt(r.read(2),10),s=parseInt(r.read(2),10),c=parseInt(r.read(2),10),f=0;u=r.readChar(),u===te.TagPoint&&(f=parseInt(r.read(3),10),u=r.readChar(),u>=48&&57>=u&&(r.skip(2),u=r.readChar(),u>=48&&57>=u&&(r.skip(2),u=r.readChar()))),t=u===te.TagUTC?new Date(Date.UTC(n,a,i,o,s,c,f)):new Date(n,a,i,o,s,c,f)}else t=u===te.TagUTC?new Date(Date.UTC(n,a,i)):new Date(n,a,i);return e.refer.set(t),t}function U(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagDate:return k(e);case te.TagRef:return K(e);default:r(t)}}function R(e){var t,r=e.stream,n=parseInt(r.read(2),10),a=parseInt(r.read(2),10),i=parseInt(r.read(2),10),u=0,o=r.readChar();return o===te.TagPoint&&(u=parseInt(r.read(3),10),o=r.readChar(),o>=48&&57>=o&&(r.skip(2),o=r.readChar(),o>=48&&57>=o&&(r.skip(2),o=r.readChar()))),t=o===te.TagUTC?new Date(Date.UTC(1970,0,1,n,a,i,u)):new Date(1970,0,1,n,a,i,u),e.refer.set(t),t}function x(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagTime:return R(e);case te.TagRef:return K(e);default:r(t)}}function M(e){if(!e.binary)throw new Error("The binary string does not support to unserialize in text mode.");var t=e.stream,r=m(t,te.TagQuote),n=new ee(t.read(r));return t.skip(1),e.refer.set(n),n}function F(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagEmpty:return new ee("");case te.TagBytes:return M(e);case te.TagRef:return K(e);default:r(t)}}function I(e){return e.binary?e.stream.readUTF8AsUTF16(1):e.stream.read(1)}function W(e){var t,r=e.stream,n=m(r,te.TagQuote);return t=e.binary?r.readUTF8AsUTF16(n):r.read(n),r.skip(1),t}function N(e){var t=W(e);return e.refer.set(t),t}function L(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagEmpty:return"";case te.TagUTF8Char:return I(e);case te.TagString:return N(e);case te.TagRef:return K(e);default:r(t)}}function D(e){var t=e.stream;t.skip(1);var r=t.read(36);return t.skip(1),e.refer.set(r),r}function P(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagGuid:return D(e);case te.TagRef:return K(e);default:r(t)}}function z(e){var t=e.stream,r=[];e.refer.set(r);for(var n=m(t,te.TagOpenbrace),a=0;n>a;a++)r[a]=b(e);return t.skip(1),r}function B(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagList:return z(e);case te.TagRef:return K(e);default:r(t)}}function H(e){var t=e.stream,r={};e.refer.set(r);for(var n=m(t,te.TagOpenbrace),a=0;n>a;a++){var i=b(e),u=b(e);r[i]=u}return t.skip(1),r}function q(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagMap:return H(e);case te.TagRef:return K(e);default:r(t)}}function $(e){var t=e.stream,r=new V;e.refer.set(r);for(var n=m(t,te.TagOpenbrace),a=0;n>a;a++){var i=b(e),u=b(e);r.set(i,u)}return t.skip(1),r}function Q(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagMap:return $(e);case te.TagRef:return K(e);default:r(t)}}function G(e){var t=e.stream,r=e.classref[m(t,te.TagOpenbrace)],n=new r.classname;e.refer.set(n);for(var a=0;a<r.count;a++)n[r.fields[a]]=b(e);return t.skip(1),n}function Y(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagClass:return Z(e),Y(e);case te.TagObject:return G(e);case te.TagRef:return K(e);default:r(t)}}function Z(e){for(var t=e.stream,r=W(e),n=m(t,te.TagOpenbrace),a=[],i=0;n>i;i++)a[i]=L(e);t.skip(1),r=y(r),e.classref.push({classname:r,count:n,fields:a})}function K(e){return e.refer.read(m(e.stream,te.TagSemicolon))}function J(e,t,r,n){g.call(this,e,n),this.useHarmonyMap=!!r,ne(this,{classref:{value:[]},refer:{value:t?ie:p()}})}var V=e.Map,X=e.hprose.StringIO,ee=e.hprose.BinaryString,te=e.hprose.Tags,re=e.hprose.ClassManager,ne=e.hprose.defineProperties,ae=e.hprose.createObject;X.utf8Decode;e.hprose.RawReader=g;var ie=ae(null,{set:{value:function(){}},read:{value:function(){r(te.TagRef)}},reset:{value:function(){}}});ne(v.prototype,{set:{value:function(e){this.ref.push(e)}},read:{value:function(e){return this.ref[e]}},reset:{value:function(){this.ref.length=0}}}),J.prototype=ae(g.prototype),J.prototype.constructor=J,ne(J.prototype,{useHarmonyMap:{value:!1,writable:!0},checkTag:{value:function(e,n){n===t&&(n=this.stream.readChar()),n!==e&&r(n,e)}},checkTags:{value:function(e,n){return n===t&&(n=this.stream.readChar()),e.indexOf(n)>=0?n:void r(n,e)}},unserialize:{value:function(){return b(this)}},readInteger:{value:function(){return C(this.stream)}},readLong:{value:function(){return _(this.stream)}},readDouble:{value:function(){return O(this.stream)}},readBoolean:{value:function(){return j(this.stream)}},readDateWithoutTag:{value:function(){return k(this)}},readDate:{value:function(){return U(this)}},readTimeWithoutTag:{value:function(){return R(this)}},readTime:{value:function(){return x(this)}},readBinaryWithoutTag:{value:function(){return M(this)}},readBinary:{value:function(){return F(this)}},readStringWithoutTag:{value:function(){return N(this)}},readString:{value:function(){return L(this)}},readGuidWithoutTag:{value:function(){return D(this)}},readGuid:{value:function(){return P(this)}},readListWithoutTag:{value:function(){return z(this)}},readList:{value:function(){return B(this)}},readMapWithoutTag:{value:function(){return this.useHarmonyMap?$(this):H(this)}},readMap:{value:function(){return this.useHarmonyMap?Q(this):q(this)}},readObjectWithoutTag:{value:function(){return G(this)}},readObject:{value:function(){return Y(this)}},reset:{value:function(){this.classref.length=0,this.refer.reset()}}}),e.HproseReader=e.hprose.Reader=J}(this),function(e){"use strict";function t(e,t,r){var i=new n,u=new a(i,t,r);return u.serialize(e),i.take()}function r(e,t,r,a){return e instanceof n||(e=new n(e)),new i(e,t,r,a).unserialize()}var n=(e.hprose.BinaryString,e.hprose.StringIO),a=e.hprose.Writer,i=e.hprose.Reader,u=e.hprose.createObject;e.hprose.Formatter=u(null,{serialize:{value:t},unserialize:{value:r}}),e.hprose.serialize=t,e.hprose.unserialize=r}(this),function(e){"use strict";e.HproseResultMode=e.hprose.ResultMode={Normal:0,Serialized:1,Raw:2,RawWithEndTag:3},e.hprose.Normal=e.hprose.ResultMode.Normal,e.hprose.Serialized=e.hprose.ResultMode.Serialized,e.hprose.Raw=e.hprose.ResultMode.Raw,e.hprose.RawWithEndTag=e.hprose.ResultMode.RawWithEndTag}(this),function(e,t){"use strict";function r(){}function n(n,a,i){function T(e,t){for(var r=0,n=$e.length;n>r;r++)e=$e[r].outputFilter(e,t);return e}function C(e,t){for(var r=$e.length-1;r>=0;r--)e=$e[r].inputFilter(e,t);return e}function E(e,t){return e=T(e,t),tt(e,t).then(function(e){return t.oneway?void 0:C(e,t)})}function _(e,t){return ut.sendAndReceive(e,t)}function A(e,t,r,n){et(e,t).then(r,function(a){O(e,t,r,n)||n(a)})}function O(t,r,n,a){if(r.failswitch&&++Me>=xe.length&&(Me=0,Re=xe[Me]),r.idempotent&&--r.retry>=0){var i=r.retry>=10?500:500*(10-r.retry);return e.setTimeout(function(){A(t,r,n,a)},i),!0}return!1}function S(e){var t={retry:Le,idempotent:!0,failswitch:!0,timeout:Ne,client:ut,userdata:{}},r=function(t){var r=null;try{var n=new c(t),a=new l(n,!0),i=n.readChar();switch(i){case o.TagError:r=new Error(a.readString());break;case o.TagFunctions:var u=a.readList();a.checkTag(o.TagEnd),U(e,u);break;default:r=new Error("Wrong Response:\r\n"+t)}}catch(s){r=s}null!==r?Ye.reject(r):Ye.resolve(e)};A(p,t,r,Ye.reject)}function j(e,t){return function(){return Qe?W(e,t,Array.slice(arguments),!0):h.all(arguments).then(function(r){return W(e,t,r,!1)})}}function k(e,r,n,a,i){if(r[a]===t&&(r[a]={},(typeof i===w||i.constructor===Object)&&(i=[i]),Array.isArray(i)))for(var u=0;u<i.length;u++){var o=i[u];if(typeof o===w)r[a][o]=j(e,n+a+"_"+o);else for(var s in o)k(e,r[a],a+"_",s,o[s])}}function U(e,r){for(var n=0;n<r.length;n++){var a=r[n];if(typeof a===w)e[a]===t&&(e[a]=j(e,a));else for(var i in a)k(e,e,"",i,a[i])}}function R(e,t){for(var r=Math.min(e.length,t.length),n=0;r>n;++n)t[n]=e[n]}function x(e){return e?{mode:s.Normal,binary:Fe,byref:Ie,simple:We,onsuccess:t,onerror:t,useHarmonyMap:He,client:ut,userdata:{}}:{mode:s.Normal,binary:Fe,byref:Ie,simple:We,timeout:Ne,retry:Le,idempotent:De,failswitch:Pe,oneway:!1,sync:!1,onsuccess:t,onerror:t,useHarmonyMap:He,client:ut,userdata:{}}}function M(e,t,r,n){var a=x(n);if(t in e){var i=e[t];for(var u in i)u in a&&(a[u]=i[u])}for(var o=0,s=r.length;s>o&&typeof r[o]!==m;++o);if(o===s)return a;var c=r.splice(o,s-o);for(a.onsuccess=c[0],s=c.length,o=1;s>o;++o){var f=c[o];switch(typeof f){case m:a.onerror=f;break;case d:a.byref=f;break;case y:a.mode=f;break;case b:for(var l in f)l in a&&(a[l]=f[l])}}return a}function F(e,t,r){var n=new c;n.write(o.TagCall);var a=new f(n,r.simple,r.binary);return a.writeString(e),(t.length>0||r.byref)&&(a.reset(),a.writeList(t),r.byref&&a.writeBoolean(!0)),n}function I(e,t,r,n){return ze?h.promise(function(a,i){Be.push({batch:n,name:e,args:t,context:r,resolve:a,reject:i})}):n?z(e,t,r):P(e,t,r)}function W(e,t,r,n){return I(t,r,M(e,t,r,n),n)}function N(e,t,r,n){try{r.onerror?r.onerror(e,t):qe(e,t),n(t)}catch(a){n(a)}}function L(e,t,r){var n=F(e,t,r);return n.write(o.TagEnd),h.promise(function(e,a){A(n.bytes,r,function(n){if(r.oneway)return void e();var i=null,u=null;try{if(r.mode===s.RawWithEndTag)i=n;else if(r.mode===s.Raw)i=n.substring(0,n.byteLength-1);else{var f=new c(n),h=new l(f,!1,r.useHarmonyMap,r.binary),g=f.readChar();if(g===o.TagResult){if(i=r.mode===s.Serialized?h.readRaw():h.unserialize(),g=f.readChar(),g===o.TagArgument){h.reset();var v=h.readList();R(v,t),g=f.readChar()}}else g===o.TagError&&(u=new Error(h.readString()),g=f.readChar());g!==o.TagEnd&&(u=new Error("Wrong Response:\r\n"+n))}}catch(p){u=p}u?a(u):e(i)},a)})}function D(e){return function(){e&&(ze=!1,u(function(e){e.forEach(function(e){"settings"in e?$(e.settings).then(e.resolve,e.reject):I(e.name,e.args,e.context,e.batch).then(e.resolve,e.reject)})},Be),Be=[])}}function P(e,t,r){r.sync&&(ze=!0);var n=h.promise(function(n,a){Ve(e,t,r).then(function(i){try{if(r.onsuccess)try{r.onsuccess(i,t)}catch(u){r.onerror&&r.onerror(e,u),a(u)}n(i)}catch(u){a(u)}},function(t){N(e,t,r,a)})});return n.whenComplete(D(r.sync)),n}function z(e,t,r){return h.promise(function(n,a){Ge.push({args:t,name:e,context:r,resolve:n,reject:a})})}function B(e){var t={timeout:Ne,binary:Fe,retry:Le,idempotent:De,failswitch:Pe,oneway:!1,sync:!1,client:ut,userdata:{}};for(var r in e)r in t&&(t[r]=e[r]);return t}function H(e,t){var r=e.reduce(function(e,r){return r.context.binary=t.binary,e.write(F(r.name,r.args,r.context)),e},new c);return r.write(o.TagEnd),h.promise(function(n,a){A(r.toString(),t,function(r){if(t.oneway)return void n(e);var i=-1,u=new c(r),f=new l(u,!1,!1,t.binary),h=u.readChar();try{for(;h!==o.TagEnd;){var g=null,v=null,p=e[++i].context.mode;if(p>=s.Raw&&(g=new c),h===o.TagResult){if(p===s.Serialized?g=f.readRaw():p>=s.Raw?(g.write(o.TagResult),g.write(f.readRaw())):(f.useHarmonyMap=e[i].context.useHarmonyMap,f.reset(),g=f.unserialize()),h=u.readChar(),h===o.TagArgument){if(p>=s.Raw)g.write(o.TagArgument),g.write(f.readRaw());else{f.reset();var d=f.readList();R(d,e[i].args)}h=u.readChar()}}else h===o.TagError&&(p>=s.Raw?(g.write(o.TagError),g.write(f.readRaw())):(f.reset(),v=new Error(f.readString())),h=u.readChar());if([o.TagEnd,o.TagResult,o.TagError].indexOf(h)<0)return void a(new Error("Wrong Response:\r\n"+r));p>=s.Raw?(p===s.RawWithEndTag&&g.write(o.TagEnd),e[i].result=g.bytes):e[i].result=g,e[i].error=v}}catch(w){return void a(w)}n(e)},a)})}function q(){Qe=!0}function $(e){if(e=e||{},Qe=!1,ze)return h.promise(function(t,r){Be.push({batch:!0,settings:e,resolve:t,reject:r})});var t=Ge.length;if(0!==t){var r=B(e);r.sync&&(ze=!0);var n=Ge;Ge=[];var a=h.promise(function(e,t){Xe(n,r).then(function(t){t.forEach(function(e){if(e.error)N(e.name,e.error,e.context,e.reject);else try{if(e.context.onsuccess)try{e.context.onsuccess(e.result,e.args)}catch(t){e.context.onerror&&e.context.onerror(e.name,t),e.reject(t)}e.resolve(e.result)}catch(t){e.reject(t)}delete e.context,delete e.resolve,delete e.reject}),e(t)},function(e){n.forEach(function(t){"reject"in t&&N(t.name,e,t.context,t.reject)}),t(e)})});return a.whenComplete(D(r.sync)),a}}function Q(){return qe}function G(e){typeof e===m&&(qe=e)}function Y(){return Re}function Z(){return Fe}function K(e){Fe=!!e}function J(){return Pe}function V(e){Pe=!!e}function X(){return Ne}function ee(e){Ne="number"==typeof e?0|e:0}function te(){return Le}function re(e){Le="number"==typeof e?0|e:0}function ne(){return De}function ae(e){De=!!e}function ie(e){Je=!!e}function ue(){return Je}function oe(){return Ie}function se(e){Ie=!!e}function ce(){return We}function fe(e){We=!!e}function le(){return He}function he(e){He=!!e}function ge(){return 0===$e.length?null:1===$e.length?$e[0]:$e.slice()}function ve(e){$e.length=0,Array.isArray(e)?e.forEach(function(e){pe(e)}):pe(e)}function pe(e){e&&"function"==typeof e.inputFilter&&"function"==typeof e.outputFilter&&$e.push(e)}function de(e){var t=$e.indexOf(e);return-1===t?!1:($e.splice(t,1),!0)}function we(e,r,n){n===t&&(typeof r===d&&(n=r,r=!1),r||(typeof e===d?(n=e,e=!1):(e&&e.constructor===Object||Array.isArray(e))&&(r=e,e=!1)));var a=ut;return n&&(a={}),e||Re?(e&&(Re=e),(typeof r===w||r&&r.constructor===Object)&&(r=[r]),Array.isArray(r)?(U(a,r),Ye.resolve(a),a):(u(S,a),Ye)):new Error("You should set server uri first!")}function ye(e,t,n){var a=arguments.length;if(1>a||typeof e!==w)throw new Error("name must be a string");if(1===a&&(t=[]),2===a&&!Array.isArray(t)){var i=[];typeof t!==m&&i.push(r),i.push(t),t=i}if(a>2){typeof n!==m&&t.push(r);for(var u=2;a>u;u++)t.push(arguments[u])}return W(ut,e,t,Qe)}function me(e,t){return Ye.then(e,t)}function be(e,t,r){if(Ze[e]){var n=Ze[e];return n[t]?n[t]:null}return r&&(Ze[e]=v(null)),null}function Te(e,r,n,a){if(typeof e!==w)throw new TypeError("topic name must be a string.");if(r===t||null===r){if(typeof n!==m)throw new TypeError("callback must be a function.");r=n}if(typeof r===m)return a=n,n=r,null===Ke&&(Ke=Ae()),void Ke.then(function(t){Te(e,t,n,a)});if(typeof n!==m)throw new TypeError("callback must be a function.");if(h.isPromise(r))return void r.then(function(t){Te(e,t,n,a)});a===t&&(a=Ne);var i=be(e,r,!0);if(null===i){var u=function(){W(ut,e,[r,i.handler,u,{idempotent:!0,failswitch:!1,timeout:a}],!1)};i={handler:function(t){var n=be(e,r,!1);if(n){if(null!==t)for(var a=n.callbacks,i=0,o=a.length;o>i;++i)try{a[i](t)}catch(s){}null!==be(e,r,!1)&&u()}},callbacks:[n]},Ze[e][r]=i,u()}else i.callbacks.indexOf(n)<0&&i.callbacks.push(n)}function Ce(e,t,r){if(e)if(typeof r===m){var n=e[t];if(n){var a=n.callbacks,i=a.indexOf(r);i>=0&&(a[i]=a[a.length-1],a.length--),0===a.length&&delete e[t]}}else delete e[t]}function Ee(e,r,n){if(typeof e!==w)throw new TypeError("topic name must be a string.");if(r===t||null===r){if(typeof n!==m)return void delete Ze[e];r=n}if(typeof r===m&&(n=r,r=null),null===r)if(null===Ke){if(Ze[e]){var a=Ze[e];for(r in a)Ce(a,r,n)}}else Ke.then(function(t){Ee(e,t,n)});else h.isPromise(r)?r.then(function(t){Ee(e,t,n)}):Ce(Ze[e],r,n)}function _e(){return Ke}function Ae(){return W(ut,"#",[],!1)}function Oe(e){rt.push(e),Ve=rt.reduceRight(function(e,t){return function(r,n,a){try{var i=t(r,n,a,e);return h.isFuture(i)?i:h.value(i)}catch(u){return h.error(u)}}},L)}function Se(e){nt.push(e),Xe=nt.reduceRight(function(e,t){return function(r,n){try{var a=t(r,n,e);return h.isFuture(a)?a:h.value(a)}catch(i){return h.error(i)}}},H)}function je(e){at.push(e),et=at.reduceRight(function(e,t){return function(r,n){try{var a=t(r,n,e);return h.isFuture(a)?a:h.value(a)}catch(i){return h.error(i)}}},E)}function ke(e){it.push(e),tt=it.reduceRight(function(e,t){return function(r,n){try{var a=t(r,n,e);return h.isFuture(a)?a:h.value(a)}catch(i){return h.error(i)}}},_)}function Ue(e){return Oe(e),ut}var Re,xe=[],Me=-1,Fe=!1,Ie=!1,We=!1,Ne=3e4,Le=10,De=!1,Pe=!1,ze=!1,Be=[],He=!1,qe=r,$e=[],Qe=!1,Ge=[],Ye=new h,Ze=v(null),Ke=null,Je=!0,Ve=L,Xe=H,et=E,tt=_,rt=[],nt=[],at=[],it=[],ut=this;Ae.sync=!0,Ae.idempotent=!0,Ae.failswitch=!0;var ot=v(null,{begin:{value:q},end:{value:$},use:{value:function(e){return Se(e),ot}}}),st=v(null,{use:{value:function(e){return je(e),st}}}),ct=v(null,{use:{value:function(e){return ke(e),ct}}});g(this,{"#":{value:Ae},onError:{get:Q,set:G},onerror:{get:Q,set:G},uri:{get:Y},id:{get:_e},binary:{get:Z,set:K},failswitch:{get:J,set:V},timeout:{get:X,set:ee},retry:{get:te,set:re},idempotent:{get:ne,set:ae},keepAlive:{get:ue,set:ie},byref:{get:oe,set:se},simple:{get:ce,set:fe},useHarmonyMap:{get:le,set:he},filter:{get:ge,set:ve},addFilter:{value:pe},removeFilter:{value:de},useService:{value:we},invoke:{value:ye},ready:{value:me},subscribe:{value:Te},unsubscribe:{value:Ee},use:{value:Ue},batch:{value:ot},beforeFilter:{value:st},afterFilter:{value:ct}}),i&&typeof i===b&&["failswitch","timeout","retry","idempotent","keepAlive","byref","simple","useHarmonyMap","filter","binary"].forEach(function(e){e in i&&ut[e](i[e])}),typeof n===w?(xe=[n],Me=0,we(n,a)):Array.isArray(n)&&(xe=n,Me=Math.floor(Math.random()*xe.length),we(xe[Me],a))}function a(e){var t=document.createElement("a");t.href=e;var r=t.protocol;if("http:"!==r&&"https:"!==r&&"tcp:"!==r&&"tcp4:"!==r&&"tcp6:"!==r&&"tcps:"!==r&&"tcp4s:"!==r&&"tcp6s:"!==r&&"tls:"!==r&&"ws:"!==r&&"wss:"!==r)throw new Error("The "+r+" client isn't implemented.")}function i(t,r,n){try{return e.hprose.HttpClient.create(t,r,n)}catch(i){}try{return e.hprose.TcpClient.create(t,r,n)}catch(i){}try{return e.hprose.WebSocketClient.create(t,r,n)}catch(i){}if("string"==typeof t)a(t);else if(Array.isArray(t))throw t.forEach(function(e){a(e)}),new Error("Not support multiple protocol.");throw new Error("You should set server uri first!")}var u=e.setImmediate,o=e.hprose.Tags,s=e.hprose.ResultMode,c=e.hprose.StringIO,f=e.hprose.Writer,l=e.hprose.Reader,h=e.hprose.Future,g=e.hprose.defineProperties,v=e.hprose.createObject,p=o.TagEnd,d="boolean",w="string",y="number",m="function",b="object";g(n,{create:{value:i}}),e.HproseClient=e.hprose.Client=n}(this),function(e){"use strict";"function"==typeof define&&(define.cmd?define("hprose",[],e.hprose):define.amd&&define("hprose",[],function(){return e.hprose})),"object"==typeof module&&"object"==typeof module.exports&&(module.exports=e.hprose)}(this);