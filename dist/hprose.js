function HproseException(e){"use strict";this.message=e}function HproseFilter(){"use strict";this.inputFilter=function(e,t){return e},this.outputFilter=function(e,t){return e}}function HproseStringInputStream(e){"use strict";var t=0,r=e.length;this.getc=function(){return e.charAt(t++)},this.read=function(r){var n=e.substr(t,r);return this.skip(r),n},this.skip=function(e){t+=e},this.readuntil=function(n){var a,i=e.indexOf(n,t);return i>=0?(a=e.substr(t,i-t),t=i+n.length):(a=e.substr(t),t=r),a}}function HproseStringOutputStream(e){"use strict";void 0===e&&(e="");var t=[e];this.write=function(e){t.push(e)},this.mark=function(){e=this.toString()},this.reset=function(){t=[e]},this.clear=function(){t=[]},this.toString=function(){return t.join("")}}var HproseResultMode={Normal:0,Serialized:1,Raw:2,RawWithEndTag:3};HproseException.prototype=new Error,HproseException.prototype.name="HproseException","isArray"in Array||(Array.isArray=function(e){"use strict";return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(void 0===this||null===this)throw new TypeError("this is null or not defined");var t=Object(this),r=t.length>>>0;if(0===r)return-1;var n=0;if(arguments.length>0&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=r)return-1;for(var a=n>=0?n:Math.max(r-Math.abs(n),0);r>a;a++)if(a in t&&t[a]===e)return a;return-1}),function(e){"use strict";var t="WeakMap"in e,r="Map"in e,n=!0;if(r&&(n="forEach"in new e.Map),!(t&&r&&n)){var a="create"in Object,i=function(){return a?Object.create(null):{}},u=i(),s=0,o=function(e){var t=i(),r=e.valueOf;a?Object.defineProperty(e,"valueOf",{value:function(n,a){return this===e&&a in u&&u[a]===n?(a in t||(t[a]=i()),t[a]):r.apply(this,arguments)},writable:!0,configurable:!0,enumerable:!1}):e.valueOf=function(n,a){return this===e&&a in u&&u[a]===n?(a in t||(t[a]=i()),t[a]):r.apply(this,arguments)}};if(t||(e.WeakMap=function T(){var e=i(),t=s++;u[t]=e;var r=function(r){if(r!==Object(r))throw new Error("value is not a non-null object");var n=r.valueOf(e,t);return n!==r.valueOf()?n:(o(r),r.valueOf(e,t))},n=a?Object.create(T.prototype,{get:{value:function(e){return r(e).value},writable:!1,configurable:!1,enumerable:!1},set:{value:function(e,t){r(e).value=t},writable:!1,configurable:!1,enumerable:!1},has:{value:function(e){return"value"in r(e)},writable:!1,configurable:!1,enumerable:!1},"delete":{value:function(e){return delete r(e).value},writable:!1,configurable:!1,enumerable:!1},clear:{value:function(){delete u[t],t=s++,u[t]=e},writable:!1,configurable:!1,enumerable:!1}}):{get:function(e){return r(e).value},set:function(e,t){r(e).value=t},has:function(e){return"value"in r(e)},"delete":function(e){return delete r(e).value},clear:function(){delete u[t],t=s++,u[t]=e}};if(arguments.length>0&&Array.isArray(arguments[0]))for(var c=arguments[0],l=0,g=c.length;g>l;l++)n.set(c[l][0],c[l][1]);return n}),!r){var c=function(){var e=i(),t=s++,r=i();u[t]=e;var n=function(n){if(null===n)return r;var a=n.valueOf(e,t);return a!==n.valueOf()?a:(o(n),n.valueOf(e,t))};return{get:function(e){return n(e).value},set:function(e,t){n(e).value=t},has:function(e){return"value"in n(e)},"delete":function(e){return delete n(e).value},clear:function(){delete u[t],t=s++,u[t]=e}}},l=function(){var e=i();return{get:function(){return e.value},set:function(t,r){e.value=r},has:function(){return"value"in e},"delete":function(){return delete e.value},clear:function(){e=i()}}},g=function(){var e=i(),t=function(e){return 0===e&&1/e===-(1/0)},r=l();return{get:function(n){return t(n)?r.get():e[n]},set:function(n,a){t(n)?r.set(n,a):e[n]=a},has:function(n){return t(n)?r.has():n in e},"delete":function(n){return t(n)?r["delete"]():delete e[n]},clear:function(){r.clear(),e=i()}}},f=function(){var e=i();return{get:function(t){return e[t]},set:function(t,r){e[t]=r},has:function(t){return t in e},"delete":function(t){return delete e[t]},clear:function(){e=i()}}};if(!a)var d=function(){var e={};return{get:function(t){return e["str_"+t]},set:function(t,r){e["str_"+t]=r},has:function(t){return"str_"+t in e},"delete":function(t){return delete e["str_"+t]},clear:function(){e={}}}};e.Map=function p(){var e={number:g(),string:a?f():d(),"boolean":f(),object:c(),"function":c(),unknown:c(),undefined:l(),"null":l()},t=0,r=[],n=a?Object.create(p.prototype,{size:{get:function(){return t},configurable:!1,enumerable:!1},get:{value:function(t){return e[typeof t].get(t)},writable:!1,configurable:!1,enumerable:!1},set:{value:function(n,a){this.has(n)||(r.push(n),t++),e[typeof n].set(n,a)},writable:!1,configurable:!1,enumerable:!1},has:{value:function(t){return e[typeof t].has(t)},writable:!1,configurable:!1,enumerable:!1},"delete":{value:function(n){return this.has(n)?(t--,r.splice(r.indexOf(n),1),e[typeof n]["delete"](n)):!1},writable:!1,configurable:!1,enumerable:!1},clear:{value:function(){r.length=0;for(var n in e)e[n].clear();t=0},writable:!1,configurable:!1,enumerable:!1},forEach:{value:function(e,t){for(var n=0,a=r.length;a>n;n++)e.call(t,this.get(r[n]),r[n],this)},writable:!1,configurable:!1,enumerable:!1}}):{size:t,get:function(t){return e[typeof t].get(t)},set:function(n,a){this.has(n)||(r.push(n),this.size=++t),e[typeof n].set(n,a)},has:function(t){return e[typeof t].has(t)},"delete":function(n){return this.has(n)?(this.size=--t,r.splice(r.indexOf(n),1),e[typeof n]["delete"](n)):!1},clear:function(){r.length=0;for(var n in e)e[n].clear();this.size=t=0},forEach:function(e,t){for(var n=0,a=r.length;a>n;n++)e.call(t,this.get(r[n]),r[n],this)}};if(arguments.length>0&&Array.isArray(arguments[0]))for(var i=arguments[0],u=0,s=i.length;s>u;u++)n.set(i[u][0],i[u][1]);return n}}if(!n){var h=e.Map;e.Map=function v(){var e=new h,t=0,r=[],n=Object.create(v.prototype,{size:{get:function(){return t},configurable:!1,enumerable:!1},get:{value:function(t){return e.get(t)},writable:!1,configurable:!1,enumerable:!1},set:{value:function(n,a){e.has(n)||(r.push(n),t++),e.set(n,a)},writable:!1,configurable:!1,enumerable:!1},has:{value:function(t){return e.has(t)},writable:!1,configurable:!1,enumerable:!1},"delete":{value:function(n){return e.has(n)?(t--,r.splice(r.indexOf(n),1),e["delete"](n)):!1},writable:!1,configurable:!1,enumerable:!1},clear:{value:function(){if("clear"in e)e.clear();else for(var n=0,a=r.length;a>n;n++)e["delete"](r[n]);r.length=0,t=0},writable:!1,configurable:!1,enumerable:!1},forEach:{value:function(e,t){for(var n=0,a=r.length;a>n;n++)e.call(t,this.get(r[n]),r[n],this)},writable:!1,configurable:!1,enumerable:!1}});if(arguments.length>0&&Array.isArray(arguments[0]))for(var a=arguments[0],i=0,u=a.length;u>i;i++)n.set(a[i][0],a[i][1]);return n}}}}(this);var HproseTags={TagInteger:"i",TagLong:"l",TagDouble:"d",TagNull:"n",TagEmpty:"e",TagTrue:"t",TagFalse:"f",TagNaN:"N",TagInfinity:"I",TagDate:"D",TagTime:"T",TagUTC:"Z",TagUTF8Char:"u",TagString:"s",TagGuid:"g",TagList:"a",TagMap:"m",TagClass:"c",TagObject:"o",TagRef:"r",TagPos:"+",TagNeg:"-",TagSemicolon:";",TagOpenbrace:"{",TagClosebrace:"}",TagQuote:'"',TagPoint:".",TagFunctions:"F",TagCall:"C",TagResult:"R",TagArgument:"A",TagError:"E",TagEnd:"z"},HproseClassManager=function(){"use strict";var e={},t=new WeakMap,r={register:function(r,n){t.set(r,n),e[n]=r},getClassAlias:function(e){return t.get(e)},getClass:function(t){return e[t]}};return r.register(Object,"Object"),r}(),HproseRawReader,HproseReader,HproseWriter;!function(e){"use strict";function t(t){var r,n=e,a=t.split(".");for(r=0;r<a.length;r++)if(n=n[a[r]],void 0===n)return null;return n}function r(e,n,a,i){if(a<n.length){var u=n[a];e[u]=i;var s=r(e,n,a+1,".");return a+1<n.length&&null===s&&(s=r(e,n,a+1,"_")),s}var o=e.join("");try{var c=t(o);return"function"==typeof c?c:null}catch(l){return null}}function n(e){var n=c.getClass(e);if(n)return n;if(n=t(e),"function"==typeof n)return c.register(n,e),n;for(var a=[],i=e.indexOf("_");i>=0;)a[a.length]=i,i=e.indexOf("_",i+1);if(a.length>0){var u=e.split("");if(n=r(u,a,0,"."),null===n&&(n=r(u,a,0,"_")),"function"==typeof n)return c.register(n,e),n}return n=function(){this.getClassName=function(){return e}},c.register(n,e),n}function a(e){return 0===e&&1/e===-(1/0)}function i(e){if(void 0===e||void 0===e.constructor)return"";var t=e.constructor,r=c.getClassAlias(t);if(r)return r;var n=t.toString();return r=n.substr(0,n.indexOf("(")).replace(/(^\s*function\s*)|(\s*$)/gi,""),""===r||"Object"===r?"function"==typeof e.getClassName?e.getClassName():"Object":("Object"!==r&&c.register(t,r),r)}function u(e,t){if(e&&t)throw new l('Tag "'+t+'" expected, but "'+e+'" found in stream');if(e)throw new l('Unexpected serialize tag "'+e+'" in stream');throw new l("No byte found in stream")}function s(){var e=[];return{set:function(t){e[e.length]=t},read:function(t){return e[t]},reset:function(){e.length=0}}}var o=HproseTags,c=HproseClassManager,l=HproseException;HproseRawReader=function(e){function t(c,l){switch(void 0===c&&(c=new HproseStringOutputStream),void 0===l&&(l=e.getc()),c.write(l),l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case o.TagNull:case o.TagEmpty:case o.TagTrue:case o.TagFalse:case o.TagNaN:break;case o.TagInfinity:case o.TagUTF8Char:c.write(e.getc());break;case o.TagInteger:case o.TagLong:case o.TagDouble:case o.TagRef:r(c);break;case o.TagDate:case o.TagTime:n(c);break;case o.TagString:a(c);break;case o.TagGuid:i(c);break;case o.TagList:case o.TagMap:case o.TagObject:s(c);break;case o.TagClass:s(c),t(c);break;case o.TagError:t(c);break;default:u(l)}return c}function r(t){var r;do r=e.getc(),t.write(r);while(r!==o.TagSemicolon)}function n(t){var r;do r=e.getc(),t.write(r);while(r!==o.TagSemicolon&&r!==o.TagUTC)}function a(t){var r=e.readuntil(o.TagQuote);t.write(r),t.write(o.TagQuote);var n=0;r.length>0&&(n=parseInt(r,10)),t.write(e.read(n+1))}function i(t){t.write(e.read(38))}function s(r){var n;do n=e.getc(),r.write(n);while(n!==o.TagOpenbrace);for(;(n=e.getc())!==o.TagClosebrace;)t(r,n);r.write(n)}this.readRaw=t};var g={set:function(){},read:function(){u(o.TagRef)},reset:function(){}};HproseReader=function(e,t,r){function a(t,r){void 0===r&&(r=e.getc()),r!==t&&u(r,t)}function i(t,r){return void 0===r&&(r=e.getc()),t.indexOf(r)>=0?r:void u(r,t)}function c(t){var r=e.readuntil(t);return 0===r.length?0:parseInt(r,10)}function f(){var t=e.getc();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case o.TagInteger:return d();case o.TagLong:return T();case o.TagDouble:return v();case o.TagNull:return null;case o.TagEmpty:return"";case o.TagTrue:return!0;case o.TagFalse:return!1;case o.TagNaN:return NaN;case o.TagInfinity:return b();case o.TagDate:return y();case o.TagTime:return H();case o.TagUTF8Char:return e.getc();case o.TagString:return C();case o.TagGuid:return R();case o.TagList:return k();case o.TagMap:return r?D():j();case o.TagClass:return x(),_();case o.TagObject:return F();case o.TagRef:return W();case o.TagError:throw new l(E());default:u(t)}}function d(){return c(o.TagSemicolon)}function h(){var t=e.getc();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case o.TagInteger:return d();default:u(t)}}function T(){var t=e.readuntil(o.TagSemicolon),r=parseInt(t,10);return r.toString()===t?r:t}function p(){var t=e.getc();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case o.TagInteger:case o.TagLong:return T();default:u(t)}}function v(){return parseFloat(e.readuntil(o.TagSemicolon))}function w(){var t=e.getc();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case o.TagInteger:case o.TagLong:case o.TagDouble:return v();case o.TagNaN:return NaN;case o.TagInfinity:return b();default:u(t)}}function b(){return e.getc()===o.TagNeg?-(1/0):1/0}function m(){var t=e.getc();switch(t){case o.TagTrue:return!0;case o.TagFalse:return!1;default:u(t)}}function y(){var t,r=parseInt(e.read(4),10),n=parseInt(e.read(2),10)-1,a=parseInt(e.read(2),10),i=e.getc();if(i===o.TagTime){var u=parseInt(e.read(2),10),s=parseInt(e.read(2),10),c=parseInt(e.read(2),10),l=0;i=e.getc(),i===o.TagPoint&&(l=parseInt(e.read(3),10),i=e.getc(),i>="0"&&"9">=i&&(e.skip(2),i=e.getc(),i>="0"&&"9">=i&&(e.skip(2),i=e.getc()))),t=i===o.TagUTC?new Date(Date.UTC(r,n,a,u,s,c,l)):new Date(r,n,a,u,s,c,l)}else t=i===o.TagUTC?new Date(Date.UTC(r,n,a)):new Date(r,n,a);return X.set(t),t}function S(){var t=e.getc();switch(t){case o.TagNull:return null;case o.TagDate:return y();case o.TagRef:return W();default:u(t)}}function H(){var t,r=parseInt(e.read(2),10),n=parseInt(e.read(2),10),a=parseInt(e.read(2),10),i=0,u=e.getc();return u===o.TagPoint&&(i=parseInt(e.read(3),10),u=e.getc(),u>="0"&&"9">=u&&(e.skip(2),u=e.getc(),u>="0"&&"9">=u&&(e.skip(2),u=e.getc()))),t=u===o.TagUTC?new Date(Date.UTC(1970,0,1,r,n,a,i)):new Date(1970,0,1,r,n,a,i),X.set(t),t}function M(){var t=e.getc();switch(t){case o.TagNull:return null;case o.TagTime:return H();case o.TagRef:return W();default:u(t)}}function O(){var t=e.read(c(o.TagQuote));return e.skip(1),t}function C(){var e=O();return X.set(e),e}function E(){var t=e.getc();switch(t){case o.TagNull:return null;case o.TagEmpty:return"";case o.TagUTF8Char:return e.getc();case o.TagString:return C();case o.TagRef:return W();default:u(t)}}function R(){e.skip(1);var t=e.read(36);return e.skip(1),X.set(t),t}function L(){var t=e.getc();switch(t){case o.TagNull:return null;case o.TagGuid:return R();case o.TagRef:return W();default:u(t)}}function k(){var t=[];X.set(t);for(var r=c(o.TagOpenbrace),n=0;r>n;n++)t[n]=f();return e.skip(1),t}function N(){var t=e.getc();switch(t){case o.TagNull:return null;case o.TagList:return k();case o.TagRef:return W();default:u(t)}}function j(){var t={};X.set(t);for(var r=c(o.TagOpenbrace),n=0;r>n;n++){var a=f(),i=f();t[a]=i}return e.skip(1),t}function I(){var t=e.getc();switch(t){case o.TagNull:return null;case o.TagMap:return j();case o.TagRef:return W();default:u(t)}}function D(){var t=new Map;X.set(t);for(var r=c(o.TagOpenbrace),n=0;r>n;n++){var a=f(),i=f();t.set(a,i)}return e.skip(1),t}function A(){var t=e.getc();switch(t){case o.TagNull:return null;case o.TagMap:return D();case o.TagRef:return W();default:u(t)}}function F(){var t=P[c(o.TagOpenbrace)],r=new t.classname;X.set(r);for(var n=0;n<t.count;n++)r[t.fields[n]]=f();return e.skip(1),r}function _(){var t=e.getc();switch(t){case o.TagNull:return null;case o.TagClass:return x(),_();case o.TagObject:return F();case o.TagRef:return W();default:u(t)}}function x(){for(var t=O(),r=c(o.TagOpenbrace),a=[],i=0;r>i;i++)a[i]=E();e.skip(1),t=n(t),P[P.length]={classname:t,count:r,fields:a}}function W(){return X.read(c(o.TagSemicolon))}function U(){P.length=0,X.reset()}HproseRawReader.call(this,e);var P=[],X=t?g:s();this.checkTag=a,this.checkTags=i,this.unserialize=f,this.readInteger=h,this.readLong=p,this.readDouble=w,this.readBoolean=m,this.readDateWithoutTag=y,this.readDate=S,this.readTimeWithoutTag=H,this.readTime=M,this.readStringWithoutTag=C,this.readString=E,this.readGuidWithoutTag=R,this.readGuid=L,this.readListWithoutTag=k,this.readList=N,this.readMapWithoutTag=j,this.readMap=I,this.readHarmonyMapWithoutTag=D,this.readHarmonyMap=A,this.readObjectWithoutTag=F,this.readObject=_,this.reset=U};var f={set:function(){},write:function(){return!1},reset:function(){}},d=function(e){var t=new Map,r=0;return{set:function(e){t.set(e,r++)},write:function(r){var n=t.get(r);return void 0!==n?(e.write(o.TagRef+n+o.TagSemicolon),!0):!1},reset:function(){t=new Map,r=0}}};HproseWriter=function(e,t){function r(e){if(void 0===e||null===e||e.constructor===Function)return void g();if(""===e)return void h();switch(e.constructor){case Boolean:T(e);break;case Number:n(e);break;case String:1===e.length?S(e):M(e);break;case Date:b(e);break;case Map:k(e);break;default:if(Array.isArray(e))C(e);else{var t=i(e);"Object"===t?R(e):j(e)}}}function n(t){t=t.valueOf(),a(t)?e.write(o.TagInteger+"-0"+o.TagSemicolon):t===(0|t)?t>=0&&9>=t?e.write(""+t):e.write(o.TagInteger+t+o.TagSemicolon):s(t)}function u(t){t>=0&&9>=t?e.write(""+t):(-2147483648>t||t>2147483647?e.write(o.TagLong):e.write(o.TagInteger),e.write(""+t+o.TagSemicolon))}function s(t){isNaN(t)?c():isFinite(t)?(a(t)&&(t="-0"),e.write(o.TagDouble+t+o.TagSemicolon)):l(t>0)}function c(){e.write(o.TagNaN)}function l(t){e.write(o.TagInfinity+(t?o.TagPos:o.TagNeg))}function g(){e.write(o.TagNull)}function h(){e.write(o.TagEmpty)}function T(t){e.write(t.valueOf()?o.TagTrue:o.TagFalse)}function p(t){_.set(t);var r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),a=("00"+t.getUTCDate()).slice(-2),i=("00"+t.getUTCHours()).slice(-2),u=("00"+t.getUTCMinutes()).slice(-2),s=("00"+t.getUTCSeconds()).slice(-2),c=("000"+t.getUTCMilliseconds()).slice(-3);e.write(o.TagDate+r+n+a+o.TagTime+i+u+s),"000"!==c&&e.write(o.TagPoint+c),e.write(o.TagUTC)}function v(e){_.write(e)||p(e)}function w(t){_.set(t);var r=("0000"+t.getFullYear()).slice(-4),n=("00"+(t.getMonth()+1)).slice(-2),a=("00"+t.getDate()).slice(-2),i=("00"+t.getHours()).slice(-2),u=("00"+t.getMinutes()).slice(-2),s=("00"+t.getSeconds()).slice(-2),c=("000"+t.getMilliseconds()).slice(-3);"00"===i&&"00"===u&&"00"===s&&"000"===c?e.write(o.TagDate+r+n+a):"1970"===r&&"01"===n&&"01"===a?(e.write(o.TagTime+i+u+s),"000"!==c&&e.write(o.TagPoint+c)):(e.write(o.TagDate+r+n+a+o.TagTime+i+u+s),"000"!==c&&e.write(o.TagPoint+c)),e.write(o.TagSemicolon)}function b(e){_.write(e)||w(e)}function m(t){_.set(t);var r=("00"+t.getHours()).slice(-2),n=("00"+t.getMinutes()).slice(-2),a=("00"+t.getSeconds()).slice(-2),i=("000"+t.getMilliseconds()).slice(-3);e.write(o.TagTime+r+n+a),"000"!==i&&e.write(o.TagPoint+i),e.write(o.TagSemicolon)}function y(e){_.write(e)||m(e)}function S(t){e.write(o.TagUTF8Char+t)}function H(t){_.set(t),e.write(o.TagString+(t.length>0?t.length:"")+o.TagQuote+t+o.TagQuote)}function M(e){_.write(e)||H(e)}function O(t){_.set(t);var n=t.length;e.write(o.TagList+(n>0?n:"")+o.TagOpenbrace);for(var a=0;n>a;a++)r(t[a]);e.write(o.TagClosebrace)}function C(e){_.write(e)||O(e)}function E(t){_.set(t);var n=[];for(var a in t)t.hasOwnProperty(a)&&"function"!=typeof t[a]&&(n[n.length]=a);var i=n.length;e.write(o.TagMap+(i>0?i:"")+o.TagOpenbrace);for(var u=0;i>u;u++)r(n[u]),r(t[n[u]]);e.write(o.TagClosebrace)}function R(e){_.write(e)||E(e)}function L(t){_.set(t);var n=t.size;e.write(o.TagMap+(n>0?n:"")+o.TagOpenbrace),t.forEach(function(e,t){r(t),r(e)}),e.write(o.TagClosebrace)}function k(e){_.write(e)||L(e)}function N(t){var n,a=i(t),u=A[a];if(void 0!==u)n=F[u];else{n=[];for(var s in t)t.hasOwnProperty(s)&&"function"!=typeof t[s]&&(n[n.length]=s.toString());u=I(a,n)}e.write(o.TagObject+u+o.TagOpenbrace),_.set(t);for(var c=n.length,l=0;c>l;l++)r(t[n[l]]);e.write(o.TagClosebrace)}function j(e){_.write(e)||N(e)}function I(t,r){var n=r.length;e.write(o.TagClass+t.length+o.TagQuote+t+o.TagQuote+(n>0?n:"")+o.TagOpenbrace);for(var a=0;n>a;a++)H(r[a]);e.write(o.TagClosebrace);var i=F.length;return A[t]=i,F[i]=r,i}function D(){A={},F.length=0,_.reset()}var A={},F=[],_=t?f:d(e);this.serialize=r,this.writeInteger=u,this.writeDouble=s,this.writeBoolean=T,this.writeUTCDate=p,this.writeUTCDateWithRef=v,this.writeDate=w,this.writeDateWithRef=b,this.writeTime=m,this.writeTimeWithRef=y,this.writeUTF8Char=S,this.writeString=H,this.writeStringWithRef=M,this.writeList=O,this.writeListWithRef=C,this.writeMap=E,this.writeMapWithRef=R,this.writeHarmonyMap=L,this.writeHarmonyMapWithRef=k,this.writeObject=N,this.writeObjectWithRef=j,this.reset=D}}(window);var HproseFormatter={serialize:function(e,t){"use strict";var r=new HproseStringOutputStream,n=new HproseWriter(r,t);return n.serialize(e),r.toString()},unserialize:function(e,t,r){"use strict";var n=new HproseStringInputStream(e),a=new HproseReader(n,t,r);return a.unserialize()}},HproseHttpRequest=function(e){"use strict";function t(e){return null===e.readyState&&(e.readyState=0,e.addEventListener("load",function(){e.readyState=4,"function"==typeof e.onreadystatechange&&e.onreadystatechange()},!1)),e}function r(){if(null!==R)return new ActiveXObject(R);for(var e=["MSXML2.XMLHTTP","MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MsXML2.XMLHTTP.2.6","Microsoft.XMLHTTP","Microsoft.XMLHTTP.1.0","Microsoft.XMLHTTP.1"],t=e.length,r=0;t>r;r++)try{var n=new ActiveXObject(e[r]);return R=e[r],n}catch(a){}throw new Error("Could not find an installed XML parser")}function n(){return T?t(new XMLHttpRequest):r()}function a(){var t="Shockwave Flash",r="application/x-shockwave-flash",n="ShockwaveFlash.ShockwaveFlash",a=navigator.plugins,i=navigator.mimeTypes,u=0,s=!1;if(a&&a[t])u=a[t].description,!u||i&&i[r]&&!i[r].enabledPlugin||(u=u.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),u=parseInt(u.replace(/^(.*)\..*$/,"$1"),10));else if(e.ActiveXObject)try{s=!0;var o=new ActiveXObject(n);o&&(u=o.GetVariable("$version"),u&&(u=u.split(" ")[1].split(","),u=parseInt(u[0],10)))}catch(c){}return 9>u?0:s?1:2}function i(){var e=a();if(b=e>0){var t=document.createElement("div");t.style.width=0,t.style.height=0,1===e?t.innerHTML=["<object ",'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ','type="application/x-shockwave-flash" ','width="0" height="0" id="',w,'" name="',w,'">','<param name="movie" value="',h,'hproseHttpRequest.swf" />','<param name="allowScriptAccess" value="always" />','<param name="quality" value="high" />','<param name="wmode" value="opaque" />',"</object>"].join(""):t.innerHTML='<embed id="'+w+'" src="'+h+'hproseHttpRequest.swf" type="application/x-shockwave-flash" width="0" height="0" name="'+w+'" allowScriptAccess="always" />',document.body.appendChild(t)}}function u(){if(!C)for(C=!0,p||v||i();M.length>0;){var e=M.shift();"function"==typeof e&&e()}}function s(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",o,!1),e.removeEventListener("load",o,!1)):(document.detachEvent("onreadystatechange",o),e.detachEvent("onload",o))}function o(){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(s(),u())}function c(){if("complete"===document.readyState)setTimeout(u,1);else if(document.addEventListener){if(document.addEventListener("DOMContentLoaded",o,!1),e.addEventListener("load",o,!1),/WebKit/i.test(navigator.userAgent))var t=setInterval(function(){/loaded|complete/.test(document.readyState)&&(clearInterval(t),o())},10)}else if(document.attachEvent){document.attachEvent("onreadystatechange",o),e.attachEvent("onload",o);var r=!1;try{r=null===window.frameElement&&document.documentElement}catch(n){}r&&r.doScroll&&!function a(){if(!C){try{r.doScroll("left")}catch(e){return setTimeout(a,15)}s(),u()}}()}else/MSIE/i.test(navigator.userAgent)&&/Windows CE/i.test(navigator.userAgent)?u():e.onload=u}function l(e,t,r,n,a){if(E)m.post(e,t,r,n,a);else{var i=function(){m.post(e,t,r,n,a)};O.push(i)}}function g(t,r,a,i,u){var s,o=n();o.onreadystatechange=function(){if(4===o.readyState)if(o.onreadystatechange=function(){},void 0!==s&&e.clearTimeout(s),200===o.status)L.__callback(i,o.responseText,!0);else{var t=o.status+":"+o.statusText;L.__callback(i,HproseTags.TagError+HproseFormatter.serialize(t,!0)+HproseTags.TagEnd)}},o.open("POST",t,!0),v&&(o.withCredentials="true");for(var c in r)o.setRequestHeader(c,r[c]);var l=function(){L.__callback(i,HproseTags.TagError+HproseFormatter.serialize("timeout",!0)+HproseTags.TagEnd)};void 0===o.timeout?s=e.setTimeout(function(){o.onreadystatechange=function(){},o.abort(),l()},u):(o.timeout=u,o.ontimeout=l),o.send(a)}function f(e,t,r,n,a){!b||p||"http://"!==e.substr(0,7).toLowerCase()&&"https://"!==e.substr(0,8).toLowerCase()?g(e,t,r,n,a):l(e,t,r,n,a)}var d=document.getElementsByTagName("script"),h=d[d.length-1].getAttribute("flashpath")||"";d=null;var T="undefined"!=typeof XMLHttpRequest,p="file:"===location.protocol,v=!p&&T&&"withCredentials"in new XMLHttpRequest,w="hprosehttprequest_as3",b=!1,m=null,y=[],S=[],H=[],M=[],O=[],C=!1,E=!1,R=null,L={};return L.post=function(e,t,r,n,a,i,u){var s=-1,o={client:u,userdata:{}};n&&(s=y.length,y[s]=n,S[s]=i,H[s]=o);for(var c=0,l=i.length;l>c;c++)r=i[c].outputFilter(r,o);if(C)f(e,t,r,s,a);else{var g=function(){f(e,t,r,s,a)};M.push(g)}},L.__callback=function(e,t,r){if(r)for(var n=S[e],a=H[e],i=n.length-1;i>=0;i--)t=n[i].inputFilter(t,a);"function"==typeof y[e]&&y[e](t),delete y[e],delete S[e],delete H[e]},L.__jsReady=function(){return C},L.__setSwfReady=function(){for(m=-1!==navigator.appName.indexOf("Microsoft")?e[w]:document[w],E=!0,e.__flash__removeCallback=function(e,t){try{e&&(e[t]=null)}catch(r){}};O.length>0;){var t=O.shift();"function"==typeof t&&t()}},c(),L}(window),HproseHttpClient=function(){"use strict";function e(e,S){function H(e){n.post(R,k,o.TagEnd,function(t){var n=null;try{var i=new a(t),s=new u(i,!0),c=i.getc();switch(c){case o.TagError:n=new r(s.readString());break;case o.TagFunctions:var l=s.readList();s.checkTag(o.TagEnd),C(e,l);break;default:n=new r("Wrong Response:\r\n"+t)}}catch(g){n=g}null!==n&&_.onError("useService",n)},N,D,_)}function M(e,t){return function(){return E(e,t,arguments)}}function O(e,t,r,n,a){if(void 0===t[n]&&(t[n]={},(typeof a===g||a.constructor===Object)&&(a=[a]),Array.isArray(a)))for(var i=0;i<a.length;i++){var u=a[i];if(typeof u===g)t[n][u]=M(e,r+n+"_"+u);else for(var s in u)O(e,t[n],n+"_",s,u[s])}}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(typeof n===g)void 0===e[n]&&(e[n]=M(e,n));else for(var a in n)O(e,e,"",a,n[a])}L=!0,_.onReady()}function E(e,c,g){var S,H,M,O=t.Normal;if(!A&&!F.length||A){var C=j,E=I,L=c.toLowerCase();H=e[c+h]||e[c+T]||e[c+p]||e[L+h]||e[L+T]||e[L+p]||_[c+h]||_[c+T]||_[c+p]||_[L+h]||_[L+T]||_[L+p],M=e[c+v]||e[c+w]||e[c+b]||e[c+m]||e[c+y]||e[L+v]||e[L+w]||e[L+b]||e[L+m]||e[L+y]||_[c+v]||_[c+w]||_[c+b]||_[c+m]||_[c+y]||_[L+v]||_[L+w]||_[L+b]||_[L+m]||_[L+y];var x=g.length,W=typeof g[x-5],U=typeof g[x-4],P=typeof g[x-3],X=typeof g[x-2],z=typeof g[x-1];z===l&&X===f&&P===l&&U===d&&W===d?(E=g[x-1],O=g[x-2],C=g[x-3],H=g[x-4],M=g[x-5],delete g[x-1],delete g[x-2],delete g[x-3],delete g[x-4],delete g[x-5],g.length-=5):z===l&&X===f&&P===d&&U===d?(E=g[x-1],O=g[x-2],H=g[x-3],M=g[x-4],delete g[x-1],delete g[x-2],delete g[x-3],delete g[x-4],g.length-=4):z===f&&X===l&&P===d&&U===d?(O=g[x-1],C=g[x-2],H=g[x-3],M=g[x-4],delete g[x-1],delete g[x-2],delete g[x-3],delete g[x-4],g.length-=4):z===l&&X===l&&P===d&&U===d?(E=g[x-1],C=g[x-2],H=g[x-3],M=g[x-4],delete g[x-1],delete g[x-2],delete g[x-3],delete g[x-4],g.length-=4):z===l&&X===d&&P===d?(C=g[x-1],H=g[x-2],M=g[x-3],delete g[x-1],delete g[x-2],delete g[x-3],g.length-=3):z===f&&X===d&&P===d?(O=g[x-1],H=g[x-2],M=g[x-3],delete g[x-1],delete g[x-2],delete g[x-3],g.length-=3):z===d&&X===d?(H=g[x-1],M=g[x-2],delete g[x-1],delete g[x-2],g.length-=2):z===l&&X===f&&P===l&&U===d?(E=g[x-1],O=g[x-2],C=g[x-3],M=g[x-4],delete g[x-1],delete g[x-2],delete g[x-3],delete g[x-4],g.length-=4):z===l&&X===f&&P===d?(E=g[x-1],O=g[x-2],M=g[x-3],delete g[x-1],delete g[x-2],delete g[x-3],g.length-=3):z===f&&X===l&&P===d?(O=g[x-1],C=g[x-2],M=g[x-3],delete g[x-1],delete g[x-2],delete g[x-3],g.length-=3):z===l&&X===l&&P===d?(E=g[x-1],C=g[x-2],M=g[x-3],delete g[x-1],delete g[x-2],delete g[x-3],g.length-=3):z===l&&X===d?(C=g[x-1],M=g[x-2],delete g[x-1],delete g[x-2],g.length-=2):z===f&&X===d?(O=g[x-1],M=g[x-2],delete g[x-1],delete g[x-2],g.length-=2):z===d&&(M=g[x-1],delete g[x-1],g.length--),S=new i(o.TagCall);var q=new s(S,E);q.writeString(c),(g.length>0||C)&&(q.reset(),q.writeList(g),C&&q.writeBoolean(!0)),A?F.push({args:g,fn:c,call:S.toString(),cb:M,eh:H}):S.write(o.TagEnd)}if(!A){var B=F.length,Q=!!B,G="";if(Q){for(var $,J=0;B>J;++J)$=F[J],G+=$.call,delete $.call;G+=o.TagEnd}else G=S.toString();var Y=F.slice(0);F.length=0,n.post(R,k,G,function(e){var n,i,s=null,l=null;if(O===t.RawWithEndTag)s=e;else if(O===t.Raw)s=e.substr(0,e.length-1);else{var f,d=new a(e),h=new u(d,!1,_.useHarmonyMap);n=-1;try{for(;(f=d.getc())!==o.TagEnd;)switch(f){case o.TagResult:O===t.Serialized?s=h.readRaw().toString():(h.reset(),s=h.unserialize()),Q&&(Y[++n].rs=s,Y[n].ex=null);break;case o.TagArgument:h.reset(),g=h.readList(),Q&&(Y[n].args=g);break;case o.TagError:h.reset(),l=new r(h.readString()),Q&&(Y[++n].ex=l);break;default:l=new r("Wrong Response:\r\n"+e),Q&&(Y[++n].ex=l)}}catch(T){l=T,Q&&(Y[0>n?0:n>=B?n-1:n].ex=l)}}for(Q||(B=1,Y=[{args:g,fn:c,rs:s,cb:M,eh:H,ex:l}]),n=0;B>n;++n)i=Y[n],l=i.ex,M=i.cb,null!==l?(H=i.eh,c=i.fn,H?H(c,l):_.onError(c,l)):M&&M(i.rs,i.args)},N,D,_)}}var R,L=!1,k={"Content-Type":"text/plain"},N=3e4,j=!1,I=!1,D=[],A=!1,F=[],_=this;_.useService=function(e,t,n){typeof t===l&&void 0===n&&(n=t);var a=_;return n&&(a={}),L=!1,void 0===e?new r("You should set server url first!"):(R=e,(typeof t===g||t&&t.constructor===Object)&&(t=[t]),Array.isArray(t)?C(a,t):H(a),a)},_.invoke=function(){var e=arguments,t=Array.prototype.shift.apply(e);return E(_,t,e)},_.setHeader=function(e,t){"content-type"!==e.toLowerCase()&&(t?k[e]=t:delete k[e])},_.setTimeout=function(e){N=e},_.getTimeout=function(){return N},_.getReady=function(){return L},_.getByRef=function(){return j},_.setByRef=function(e){void 0===e&&(e=!0),j=e},_.getFilter=function(){return 0===D.length?null:D[0]},_.setFilter=function(e){D.length=0,void 0!==e&&null!==e&&D.push(e)},_.addFilter=function(e){D.push(e)},_.removeFilter=function(e){var t=D.indexOf(e);return-1===t?!1:(D.splice(t,1),!0)},_.getSimpleMode=function(){return I},_.setSimpleMode=function(e){void 0===e&&(e=!0),I=e},_.beginBatch=function(){A=!0},_.endBatch=function(){A=!1,F.length&&E()},_.useHarmonyMap=!1,_.onReady=c,_.onError=c,typeof e===g&&_.useService(e,S)}var t=HproseResultMode,r=HproseException,n=HproseHttpRequest,a=HproseStringInputStream,i=HproseStringOutputStream,u=HproseReader,s=HproseWriter,o=HproseTags,c=function(){},l="boolean",g="string",f="number",d="function",h="_OnError",T="_onError",p="_onerror",v="_Callback",w="_callback",b="_OnSuccess",m="_onSuccess",y="_onsuccess";return e.create=function(t,r){return new e(t,r)},e}(),JSONRPCClientFilter=function(e){"use strict";var t=1,r={version:"2.0",inputFilter:function(e,t){var r=JSON.parse(e),n=new HproseStringOutputStream,a=new HproseWriter(n,!0);return r.error?(n.write(HproseTags.TagError),a.writeString(r.error.message)):(n.write(HproseTags.TagResult),a.serialize(r.result)),n.write(HproseTags.TagEnd),n.toString()},outputFilter:function(e,r){var n={};"1.1"===this.version?n.version="1.1":"2.0"===this.version&&(n.jsonrpc="2.0");var a=new HproseStringInputStream(e),i=new HproseReader(a,!1),u=a.getc();return u===HproseTags.TagCall&&(n.method=i.readString(),u=a.getc(),u===HproseTags.TagList&&(n.params=i.readListWithoutTag())),n.id=t++,JSON.stringify(n)}};return r}(window);